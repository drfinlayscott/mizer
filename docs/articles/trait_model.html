<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trait-Based Model • mizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Trait-Based Model">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mizer.html">Get Started</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gustavdelius/mizer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Trait-Based Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sizespectrum/mizer/blob/master/vignettes/trait_model.Rmd"><code>vignettes/trait_model.Rmd</code></a></small>
      <div class="hidden name"><code>trait_model.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The trait-based size spectrum model can be derived as a simplification of the general model outline in the <a href="model_description.html">model description</a> section. It is more complicated than a <a href="community_model.html">community model</a> and the most significant difference between the two is that while the community model only resolves a single <em>species</em>, the trait-based model resolves many species. In a trait-based model the asymptotic size is considered to be the most important <em>trait</em> characterizing a species. All of the species-specific parameters, such as <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>, are the same for all species. Other model parameters are determined by the asymptotic size. For example, the weight at maturation, <span class="math inline">\(w_{m.i} = \eta w_{\infty.i}\)</span>, where <span class="math inline">\(\eta = 0.25\)</span>. The number of species is not important and does not affect the general dynamics of the model. The asymptotic sizes of the species are spread evenly over the size range of the community.</p>
</div>
<div id="sec:set_up_trait_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:set_up_trait_model" class="anchor"></a>Setting up a trait-based model</h2>
<p>To help set up a trait-based model, there is a wrapper function, <code><a href="../reference/set_trait_model.html">set_trait_model()</a></code>. Like the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function described in the section on the <a href="community_model.html">community model</a>, this function can take many arguments. Most of them have default values so you don’t need to worry about them for the moment. See the help page for more details.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">?set_trait_model</a></code></pre></div>
<p>The main parameters of interest are the number of the species in the model (<code>no_sp</code>) and the minimum and maximum asymptotic sizes (<code>min_w_inf</code> and <code>max_w_inf</code> respectively); the asymptotic sizes are spread evenly on a logarithmic scale between these values.</p>
<p>One of the key differences between the community type model and the trait-based model is that reproduction and egg production are considered. In the community model, recruitment is constant and there is no relationship between the abundance in the community and egg production. In the trait-based model, the egg production is modeled using a <em>Beverton-Holt</em> type function (the default in <code>mizer</code>, see <a href="model_description.html#sec:recruitment">the section on stock-recruitment relationships</a>) where the recruitment flux <span class="math inline">\(R_i\)</span> (numbers per time) approaches a maximum recruitment as the egg production increases. The maximum recruitment flux is calculated using equilibrium theory and a recruitment multiplier <span class="math inline">\(k_0\)</span>, which can be passed in as an argument (<code>k0</code>) to the <code><a href="../reference/set_trait_model.html">set_trait_model()</a></code> function. <code>k0</code> has a default value of 50.</p>
<p>Here we set up the model to have 10 species, with asymptotic sizes ranging from 10 g to 100 kg. All the other parameters have default values.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_trait_model.html">set_trait_model</a></span>(<span class="dt">no_sp =</span> <span class="dv">10</span>, <span class="dt">min_w_inf =</span> <span class="dv">10</span>, <span class="dt">max_w_inf =</span> <span class="fl">1e5</span>)</a></code></pre></div>
<pre><code>## Note: No gamma provided for some species, so using f0, h, beta, sigma, lambda and kappa to calculate it.</code></pre>
<p>The output reminds the user that <span class="math inline">\(\gamma\)</span> was not specified, and so will be calculated using other parameters.</p>
<p>This function returns an object of type <code>MizerParams</code>, which holds all the model information, including species parameters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(params)</a></code></pre></div>
<pre><code>## [1] "MizerParams"
## attr(,"package")
## [1] "mizer"</code></pre>
<p>This object can therefore be interrogated in the same way as described in <a href="community_model.html">the section on the community model</a>, either by inspecting the individual slots or by using the <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(params)</a></code></pre></div>
<pre><code>## An object of class "MizerParams" 
## Consumer size spectrum:
##  minimum size:   0.001
##  maximum size:   1e+05
##  no. size bins:  100
## Plankton size spectrum:
##  minimum size:   1.91791e-07
##  maximum size:   1e+05
##  no. size bins:  146
## Species details:
##    species        w_inf        w_mat beta sigma
## 1        1     10.00000     2.500000  100   1.3
## 2        2     27.82559     6.956399  100   1.3
## 3        3     77.42637    19.356592  100   1.3
## 4        4    215.44347    53.860867  100   1.3
## 5        5    599.48425   149.871063  100   1.3
## 6        6   1668.10054   417.025134  100   1.3
## 7        7   4641.58883  1160.397208  100   1.3
## 8        8  12915.49665  3228.874163  100   1.3
## 9        9  35938.13664  8984.534160  100   1.3
## 10      10 100000.00000 25000.000000  100   1.3
## Fishing gear details:
##  Gear            Target species
##   knife_edge_gear         1 2 3 4 5 6 7 8 9 10</code></pre>
<p>The summary shows us that now we have 10 species in the model, with asymptotic sizes ranging from<br><span class="math inline">\(10\)</span> to <span class="math inline">\(10^{5}\)</span>. The size at maturity (<code>w_mat</code>) is linearly related to the asymptotic size. Each species has the same preferred predator-prey mass ratio parameter values (<code>beta</code> and <code>sigma</code>, see <a href="model_description.html#sec:ppmr">the section on predator/prey mass ratio</a>). There are <span class="math inline">\(100\)</span> size bins in the community and <span class="math inline">\(146\)</span> size bins including the plankton spectrum. Ignore the summary section on fishing gear for the moment. This is explained later.</p>
</div>
<div id="sec:running_trait_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:running_trait_model" class="anchor"></a>Running the trait-based model</h2>
<p>As with the community model described above, we can project the model through time using the <code><a href="../reference/project.html">project()</a></code> method. Here we project the model for 75 time steps without any fishing (the <code>effort</code> argument is set to 0). We use the default initial population abundances given by the <code><a href="../reference/get_initial_n.html">get_initial_n()</a></code> function so there is no need to pass in any initial population values (see <a href="running_a_simulation.html#sec:setting_initial_abundances">the section on setting the initial abundances</a>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params, <span class="dt">t_max=</span><span class="dv">75</span>, <span class="dt">effort =</span> <span class="dv">0</span>)</a></code></pre></div>
<p>This results in a <code>MizerSim</code> object which contains the abundances of the community and plankton spectra through time, as well as the original <code>MizerParams</code> object. As with the community model, we can get a quick overview of the results of the simulation by calling the generic <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> method:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_comm_sim_2-1.png" alt="Example plot of the trait-based model with no fishing." width="700"><p class="caption">
Example plot of the trait-based model with no fishing.
</p>
</div>
<p>The summary plot has the same panels as the one generated by the community model, but here you can see that all the species in the community are plotted. The panels show the situation in the final time step of the simulation, apart from the biomass through time plot. As this is a trait-based model where all species fully interact with each other, the predation mortality (M2) and feeding level by size is the same for each species. The biomasses quickly settle down to equilibria. In this simulation we turned fishing off so the fishing mortality is 0. The size-spectra show the abundances at size to be evenly spaced by asymptotic size.</p>
</div>
<div id="sec:trophic_cascade_trait_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:trophic_cascade_trait_model" class="anchor"></a>Example of a trophic cascade with the trait-based model</h2>
<p>As with the community model, it is possible to use the trait-based model to simulate a trophic cascade. Again, we perform two simulations, one with fishing and one without. We therefore need to consider how fishing gears and selectivity have been set up by the <code><a href="../reference/set_trait_model.html">set_trait_model()</a></code> function.</p>
<p>The default fishing selectivity function is a knife-edge function, which only selects individuals larger than 1000 g. There is also only one fishing gear in operation, and this selects all of the species. You can see this if you call the <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code> method on the <code>params</code> argument we set up above. At the bottom of the summary there is a section on <em>Fishing gear details</em>. You can see that there is only one gear, called `<code>knife_edge_gear'' and that it selects species 1 to 10. To control the size at which individuals are selected there is a</code>knife_edge_size<code>argument to the</code>set_trait_model()` function. This has a default value of 1000 g.</p>
<p>In <code>mizer</code> it is possible to include more than one fishing gear in the model and for different species to be caught by different gears. We will ignore this for now, but will explore it further below when we introduce an industrial fishery to the trait-based model.</p>
<p>To set up the trait-based model to have fishing we set up the <code>MizerParams</code> object in exactly the same way as we did before but here the <code>knife_edge_size</code> argument is explicitly passed in for clarity:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">params_knife &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_trait_model.html">set_trait_model</a></span>(<span class="dt">no_sp =</span> <span class="dv">10</span>, <span class="dt">min_w_inf =</span> <span class="dv">10</span>, <span class="dt">max_w_inf =</span> <span class="fl">1e5</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">    <span class="dt">knife_edge_size =</span> <span class="dv">1000</span>)</a></code></pre></div>
<pre><code>## Note: No gamma provided for some species, so using f0, h, beta, sigma, lambda and kappa to calculate it.</code></pre>
<p>First we perform a simulation without fishing in the same way we did above by setting the <code>effort</code> argument to 0:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">sim0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_knife, <span class="dt">effort =</span> <span class="dv">0</span>, <span class="dt">t_max =</span> <span class="dv">75</span>)</a></code></pre></div>
<p>Now we simulate with fishing. Here, we use an effort of 0.75. As mentioned in <a href="community_model.html#sec:trophic_cascade_comm_model">the section on trophic cascades in the community model</a>, the fishing mortality on a species is calculated as the product of effort, catchability and selectivity (see <a href="multispecies_model.html#sec:fishing_gear">the section on fishing gears</a> for more details). Selectivity ranges between 0 (not selected) and 1 (fully selected). The default value of catchability is 1. Therefore, in this simulation the fishing mortality of a fully selected individual is simply equal to the effort. This effort is constant throughout the duration of the simulation (however, this is does not necessarily have to be the case).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sim1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_knife, <span class="dt">effort =</span> <span class="fl">0.75</span>, <span class="dt">t_max =</span> <span class="dv">75</span>)</a></code></pre></div>
<p>Again, we can plot the summary of the fished community using the default <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> function. The knife-edge selectivity at 1000 g can be clearly seen in the fishing mortality panel:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim1)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_trait_fmort-1.png" alt="Summary plot for the trait-based model when fishing with knife-edge selectivity at size = 1000 g." width="700"><p class="caption">
Summary plot for the trait-based model when fishing with knife-edge selectivity at size = 1000 g.
</p>
</div>
<p>The trophic cascade can be explored by comparing the total abundances of all species at size when the community is fished and unfished. As mentioned above, the abundances are stored in the <code>n</code> slot of the <code>MizerSim</code> object. The <code>n</code> slot returns a three dimensional array with dimensions time x species x size. Here we have 76 time steps (75 from the simulation plus one which stores the initial population), 10 species and 100 sizes:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sim0<span class="op">@</span>n)</a></code></pre></div>
<pre><code>## [1]  76  10 100</code></pre>
<p>As with the community model, we are interested in the relative total abundances by size in the final time step so we want to pull out the 76th time step from the abundances and sum over the species. We can use the <code><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply()</a></code> function to help us:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">total_abund0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(sim0<span class="op">@</span>n[<span class="dv">76</span>,,],<span class="dv">2</span>,sum)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">total_abund1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(sim1<span class="op">@</span>n[<span class="dv">76</span>,,],<span class="dv">2</span>,sum)</a></code></pre></div>
<p>We can then use these vectors to calculate the relative abundances:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">relative_abundance &lt;-<span class="st"> </span>total_abund1 <span class="op">/</span><span class="st"> </span>total_abund0</a></code></pre></div>
<p>Which can be plotted using the commands below:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x=</span>sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y=</span>relative_abundance, <span class="dt">log=</span><span class="st">"xy"</span>, <span class="dt">type=</span><span class="st">"n"</span>, <span class="dt">xlab =</span> <span class="st">"Size (g)"</span>,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">    <span class="dt">ylab=</span><span class="st">"Relative abundance"</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x=</span>sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y=</span>relative_abundance)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(sim0<span class="op">@</span>params<span class="op">@</span>w),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(sim0<span class="op">@</span>params<span class="op">@</span>w)), <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_relative_comm_abund2-1.png" alt="Relative abundances from the unfished (dashed line) and fished (solid line) trait based model." width="700"><p class="caption">
Relative abundances from the unfished (dashed line) and fished (solid line) trait based model.
</p>
</div>
<p>The impact of fishing on species larger than 1000 g can be clearly seen. The fishing pressure lowers the abundance of large fish (<span class="math inline">\(&gt; 1000\)</span> g). This then relieves the predation pressure on their smaller prey (the preferred predator-prey size ratio is given by the <span class="math inline">\(\beta\)</span> parameter, which is set to 100 by default), leading to an increase in their abundance. This in turn increases the predation mortality on their smaller prey, which reduces their abundance and so on.</p>
<p>This impact can also be seen by looking at the predation mortality by size. The predation mortalities are retrieved using the <code><a href="../reference/getM2.html">getM2()</a></code> method for <code>MizerSim</code> objects. This returns a three dimensional array of predation mortalities by time x species x size (see the help page for <code><a href="../reference/getM2.html">getM2()</a></code> for more details). As mentioned above, for the trait based model the predation mortality by size is the same for each species. Therefore we only look at the predation mortality of the first species.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">m2_no_fishing &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getM2.html">getM2</a></span>(sim0)[<span class="dv">76</span>,<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">m2_with_fishing &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getM2.html">getM2</a></span>(sim1)[<span class="dv">76</span>,<span class="dv">1</span>,]</a></code></pre></div>
<p>The predation mortalities can then be plotted.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y =</span> m2_no_fishing, <span class="dt">log=</span><span class="st">"x"</span>, <span class="dt">type=</span><span class="st">"n"</span>, <span class="dt">xlab =</span> <span class="st">"Size (g)"</span>,</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">    <span class="dt">ylab =</span> <span class="st">"M2"</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y =</span> m2_no_fishing, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y =</span> m2_with_fishing)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_relative_trait_m2-1.png" alt="Predation mortalities from the unfished (dashed line) and fished (solid line) trait-based model." width="700"><p class="caption">
Predation mortalities from the unfished (dashed line) and fished (solid line) trait-based model.
</p>
</div>
</div>
<div id="sec:trait_additional_gear" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:trait_additional_gear" class="anchor"></a>Setting up an industrial fishing gear</h2>
<p>In this section we only want to operate an <em>industrial</em> fishery. Industrial fishing targets the small zooplanktivorous species that are typically used for fishmeal production.</p>
<p>In the previous simulations we had only one fishing gear and it targeted all the species in the community. This gear had a knife-edge selectivity that only selected species larger than 1 kg. Here we expand the model to include multiple fishing gears. This requires us to look more closely at how fishing gears are handled in <code>mizer</code>. In <code>mizer</code> it is possible for a fishing gear to catch only a subset of the species in the model. This is useful because when running a simulation with <code><a href="../reference/project.html">project()</a></code> you can specify the effort per gear and so you can turn gears on or off as you want. The shape of the selectivity function of each gear will be the same for all of the species it catches but the selectivity parameter values for each species may be different. For example, we can set up an <em>industrial</em> gear to catch only a subset of species. Each species it catches will be caught with knife-edge selectivity but they may have a different knife-edge positions.</p>
<p>Using the trait-based model wrapper function it is only possible to have a knife-edge selectivity. Each species in the model must be given the position of the knife edge and the name of the fishing gear. This is done using the <code>knife_edge_size</code> argument and the <code>gear_names</code> argument of the <code><a href="../reference/set_trait_model.html">set_trait_model()</a></code> function. In the previous examples, we passed in the <code>knife_edge_size</code> argument as a single value which was used for all the species. This effectively set up a single gear, that caught all species using the same selectivity pattern. The <code>gear_names</code> argument was not used. Now we are going to pass the <code>knife_edge_size</code> argument as a vector with the same length as the number of species in the model. The values in the vector will be the positions of the knife-edge for each species. We are also going to pass in a new argument, <code>gear_names</code> which is a vector of the names of the gears. The vector must have the same length as the number of species in the model.</p>
<p>We will set up the model to include two fishing gears: an <em>industrial</em> gear that only catches species with an asymptotic size less than or equal to 500g, and a second gear, ``other’’, that catches everything else. The position of the knife-edge for both gears will occur at 0.05 x the asymptotic size i.e. the selectivity parameters will be different for each species and will depend on the asymptotic size.</p>
<p>To start with we need to know what the asymptotic sizes of the species in the model are so we can determine the knife-edge positions for each species. As mentioned above, the <code><a href="../reference/set_trait_model.html">set_trait_model()</a></code> function spaces the asymptotic sizes equally on a logarithmic scale. This means we can calculate them by hand.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">no_sp &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">min_w_inf &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">max_w_inf &lt;-<span class="st"> </span><span class="fl">1e5</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">w_inf &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log10</a></span>(min_w_inf), <span class="dt">to =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log10</a></span>(max_w_inf), <span class="dt">length=</span>no_sp)</a></code></pre></div>
<p>We can then use these asymptotic sizes to set a vector of knife-edges that are 0.05 times the asymptotic size:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">knife_edges &lt;-<span class="st"> </span>w_inf <span class="op">*</span><span class="st"> </span><span class="fl">0.05</span></a></code></pre></div>
<p>Now we want to assign each species to either the <em>industrial</em> or <em>other</em> gear, We want to create a vector of gear names. This vector must be the same length as the number of species in the model.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">other_gears &lt;-<span class="st"> </span>w_inf <span class="op">&gt;</span><span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">gear_names &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"Industrial"</span>, no_sp)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">gear_names[other_gears] &lt;-<span class="st"> "Other"</span></a></code></pre></div>
<p>Finally, we can create our <code>MizerParams</code> object by passing in the <code>knife_edge_sizes</code> and <code>gear_names</code> argument. All the other arguments are the same as before:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">params_multi_gear &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_trait_model.html">set_trait_model</a></span>(<span class="dt">no_sp =</span> no_sp, <span class="dt">min_w_inf =</span> min_w_inf,</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">    <span class="dt">max_w_inf =</span> max_w_inf, <span class="dt">knife_edge_size =</span> knife_edges, <span class="dt">gear_names =</span> gear_names)</a></code></pre></div>
<pre><code>## Note: No gamma provided for some species, so using f0, h, beta, sigma, lambda and kappa to calculate it.</code></pre>
<p>To check what has just happened we can take a look inside the <code>MizerParams</code> object. There is a slot in the object called <code>species_params</code>. This is a <code>data.frame</code> that contains the life-history parameters of the species in the model (the results of running this command are not shown):</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">params_multi_gear<span class="op">@</span>species_params</a></code></pre></div>
<p>This <code>data.frame</code> is pretty interesting as it allows you to investigate the parameters for each species. For example, you can see that the predator-prey mass ratio parameters, <code>beta</code> and <code>sigma</code>, are indeed the same for each species. The columns of the <code>species_params</code> <code>data.frame</code> that we are interested in here are <code>species</code> (the name of the species, here just numerical identifiers), <code>w_inf</code> (the asymptotic size), <code>sel_func</code> (the name of the selectivity function for that species), <code>knife_edge_size</code> (the position of the knife-edge of the selectivity) and <code>gear</code> (the name of the fishing gear). You can see that two gears have been set up, <em>Industrial</em> and <em>Other</em> and that they catch different species depending on their asymptotic size.</p>
<p>Having created our <code>MizerParams</code> object with multiple gears, we can now turn our attention to running a projection with multiple gears. In our previous examples of calling <code><a href="../reference/project.html">project()</a></code> we have specified the fishing effort with the <code>effort</code> argument using a single value. This fixes the fishing effort for all gears in the model, for all time steps. We can do this with our multi-gear parameter object:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">sim_multi_gear &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_multi_gear, <span class="dt">t_max =</span> <span class="dv">75</span>, <span class="dt">effort =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p>By plotting this you can see that the fishing mortality for each species now has a different selectivity pattern, and that the position of the selectivity knife-edge is given by the asymptotic size of the species.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim_multi_gear)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_multi_gear_trait_single_effort-1.png" alt="Summary plot for the trait-based model with multiple gears when all gears are operational." width="700"><p class="caption">
Summary plot for the trait-based model with multiple gears when all gears are operational.
</p>
</div>
<p>For the industrial fishery we said that we only wanted species with an asymptotic size of 500 g or less to be fished. There are several ways of specifying the <code>effort</code> argument for <code><a href="../reference/project.html">project()</a></code> . Above we specified a single value that was used for all gears, for all time steps. It is also possible to specify a separate effort for each gear that will be used for all time steps. To do this we pass in effort as a named vector. Here we set the effort for the <em>Industrial</em> gear to 0.75, and the effort of the <em>Other</em> gear to 0 (effectively turning it off).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">sim_multi_gear &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_multi_gear, <span class="dt">t_max =</span> <span class="dv">75</span>,</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">    <span class="dt">effort =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">Industrial =</span> <span class="fl">0.75</span>, <span class="dt">Other =</span> <span class="dv">0</span>))</a></code></pre></div>
<p>Now you can see that the <em>Industrial</em> gear has been operating and that fishing mortality for species larger than 500 g is 0.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim_multi_gear)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_multi_gear_trait-1.png" alt="Summary plot for the trait-based model with multiple gears when only the industrial gear that fishes on species with asymptotic size of 500 g or less is operational." width="700"><p class="caption">
Summary plot for the trait-based model with multiple gears when only the industrial gear that fishes on species with asymptotic size of 500 g or less is operational.
</p>
</div>
</div>
<div id="the-impact-of-industrial-fishing" class="section level2">
<h2 class="hasAnchor">
<a href="#the-impact-of-industrial-fishing" class="anchor"></a>The impact of industrial fishing</h2>
<p>In the previous section we set up and ran a model in which an industrial fishery was operating that only selected smaller species. We can now answer the question: what is the impact of such a fishery? We can again compare abundances of the fished (<code>sim_industrial1</code>) and unfished (<code>sim_industrial0</code>) cases:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">sim_industrial0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_multi_gear, <span class="dt">t_max =</span> <span class="dv">75</span>, <span class="dt">effort =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">sim_industrial1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_multi_gear, <span class="dt">t_max =</span> <span class="dv">75</span>,</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">    <span class="dt">effort =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">Industrial =</span> <span class="fl">0.75</span>, <span class="dt">Other =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">total_abund0 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(sim_industrial0<span class="op">@</span>n[<span class="dv">76</span>,,],<span class="dv">2</span>,sum)</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">total_abund1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(sim_industrial1<span class="op">@</span>n[<span class="dv">76</span>,,],<span class="dv">2</span>,sum)</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">relative_abundance &lt;-<span class="st"> </span>total_abund1 <span class="op">/</span><span class="st"> </span>total_abund0</a></code></pre></div>
<p>And plot the relative abundances:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x=</span>sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y=</span>relative_abundance, <span class="dt">log=</span><span class="st">"xy"</span>, <span class="dt">type=</span><span class="st">"n"</span>, <span class="dt">xlab =</span> <span class="st">"Size (g)"</span>,</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">    <span class="dt">ylab=</span><span class="st">"Relative abundance"</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>,<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x=</span>sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y=</span>relative_abundance)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(sim0<span class="op">@</span>params<span class="op">@</span>w),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(sim0<span class="op">@</span>params<span class="op">@</span>w)), <span class="dt">y=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<div class="figure">
<img src="trait_model_files/figure-html/plot_relative_comm_abund_industrial-1.png" alt="Relative abundances from the unfished (dashed line) and fished (solid line) trait based model with an industrial fishery that targets species with an asymptotic size of 500 g or less." width="700"><p class="caption">
Relative abundances from the unfished (dashed line) and fished (solid line) trait based model with an industrial fishery that targets species with an asymptotic size of 500 g or less.
</p>
</div>
<p>This shows another trophic cascade, although this time one driven by fishing the species at the midrange part of the spectrum, not the largest individuals as before. This trophic cascade acts in both directions. The cascade upwards is driven by the lack of food for predators leading to smaller realised maximum sizes. The cascade downwards has the same mechanism as fishing on large fish, a combination of predation mortality and food limitation.</p>
<p>The next section explains how to setup the more general <a href="multispecies_model.html">multispecies model.</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#sec:set_up_trait_model">Setting up a trait-based model</a></li>
      <li><a href="#sec:running_trait_model">Running the trait-based model</a></li>
      <li><a href="#sec:trophic_cascade_trait_model">Example of a trophic cascade with the trait-based model</a></li>
      <li><a href="#sec:trait_additional_gear">Setting up an industrial fishing gear</a></li>
      <li><a href="#the-impact-of-industrial-fishing">The impact of industrial fishing</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Finlay Scott, Julia Blanchard, Ken Andersen, Gustav Delius.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'de91577b2f58755afaa137388a513a88',
    indexName: 'mizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
