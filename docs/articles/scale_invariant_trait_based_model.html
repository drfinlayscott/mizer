<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scale-Invariant, Trait-Based Model • mizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Scale-Invariant, Trait-Based Model">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mizer.html">Get Started</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gustavdelius/mizer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Scale-Invariant, Trait-Based Model</h1>
            
      
      <small class="dont-index"><a href="https://github.com/gustavdelius/mizer/edit/master/vignettes/scale_invariant_trait_based_model.Rmd">Edit this page.  </a> Source: <a href="https://github.com/gustavdelius/mizer/blob/master/vignettes/scale_invariant_trait_based_model.Rmd"><code>vignettes/scale_invariant_trait_based_model.Rmd</code></a></small>
      <div class="hidden name"><code>scale_invariant_trait_based_model.Rmd</code></div>

    </div>

    
    
<div id="sec:scale_invariant_trait_based_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:scale_invariant_trait_based_model" class="anchor"></a>Introduction</h2>
<p>Constructing models that allow fish species to coexist is not trivial. This applies as much to size-spectrum models that use the mizer software tool, as it does to other kinds of multispecies models. Current size-spectrum models achieve coexistence by assuming that stock-recruitment relationships are strong enough within species to promote coexistence of the species. They do this by making the controlling parameter <span class="math inline">\(R_{max.i}\)</span> (described in <a href="model_description.html#sec:recruitment">the section on the stock-recruitment relationship</a>) and keeping recruitment sufficiently low. Although coexistence can be achieved in this way, it can necessitate rather small values of <span class="math inline">\(R_{max.i}\)</span>, with major effects on persistence and stability of species.</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_scale_sense2-1.png" alt="Biomass plots following introduction of fishing (1) in the trait-based model, and (2) in the scale-invariant model developed here." width="700"><p class="caption">
Biomass plots following introduction of fishing (1) in the trait-based model, and (2) in the scale-invariant model developed here.
</p>
</div>
<p>In the plot above there are ten species; <span class="math inline">\(w_\infty\)</span> is taken over a range 10 g to 1000 g, uniformly spaced on the log-scaled mass axis. The initial state is close to the steady state in the absence of fishing.<br>
Recruitment to the multispecies fishery is knife-edge at 100 g and fishing mortality rate is set at <span class="math inline">\(F = 1\)</span> yr<span class="math inline">\(^{-1}\)</span>.</p>
<p>This and the next section (i.e., <a href="scale_invariant_trait_based_model.html#sec:explicit">the section on implementing explicit species in a scale-invariant background</a>) provide an alternative way of generating sets of coexisting species, without the need for such strong stock-recruitment relationships. This makes stocks more sensitive to changes in the environment, such as those caused by fishing. To motivate the new approach, the above figure compares it with the trait-based model described in <a href="trait_model.html">the section on the trait-based model</a> in the presence of a substantial amount of fishing. In the case of the trait-based model, all species persist under fishing. In this instance, the species with largest maximum weight enters the fishery at about half of its weight at maturation, and persists because its stock-recruitment relationship is sufficiently strong to boost its rate of increase when rare. The figure can constructed using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">params_trait &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_trait_model.html">set_trait_model</a></span>(<span class="dt">no_sp =</span> <span class="dv">10</span>, <span class="dt">min_w_inf =</span> <span class="dv">10</span>, <span class="dt">max_w_inf =</span> <span class="fl">1e3</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                          <span class="dt">knife_edge_size =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">sim_trait_initial &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_trait, <span class="dt">t_max=</span><span class="dv">100</span>, <span class="dt">effort =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">sim_trait &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_trait,</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                     <span class="dt">initial_n =</span> sim_trait_initial<span class="op">@</span>n[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                         sim_trait_initial<span class="op">@</span>n)[<span class="dv">1</span>],,],</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">                     <span class="dt">initial_n_pp =</span> sim_trait_initial<span class="op">@</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">                         </span>n_pp[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sim_trait_initial<span class="op">@</span>n_pp)[<span class="dv">1</span>],], <span class="dt">t_max=</span><span class="dv">15</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">                     <span class="dt">effort =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw"><a href="../reference/plotBiomass.html">plotBiomass</a></span>(sim_trait)</a></code></pre></div>
<p><img src="scale_invariant_trait_based_model_files/figure-html/demo_trait_model_insensitive-1.png" width="700"></p>
<p>The approach developed below allows the stock-recruitment relationship to be weakened or completely removed, with the result that species are more sensitive to fishing (see the figure below).<br>
In the example shown, fishing drives the largest and most vulnerable species to extinction (there is no stock-recruitment relationship in this instance).<br>
Some density-dependent feedbacks still remain, but they emerge from the internal dynamics.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_scaling_model.html">set_scaling_model</a></span>(<span class="dt">no_sp =</span> <span class="dv">10</span>, <span class="dt">min_w_inf =</span> <span class="dv">10</span>, <span class="dt">max_w_inf =</span> <span class="fl">1e3</span>,</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">                            <span class="dt">min_egg =</span> <span class="fl">1e-4</span>, <span class="dt">min_w_mat =</span> <span class="dv">10</span><span class="op">^</span>(<span class="fl">0.4</span>), <span class="dt">rfac =</span> <span class="ot">Inf</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                            <span class="dt">knife_edge_size =</span> <span class="dv">100</span>,<span class="dt">kappa =</span> <span class="fl">0.005</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params, <span class="dt">t_max=</span><span class="dv">15</span>, <span class="dt">effort =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw"><a href="../reference/plotBiomass.html">plotBiomass</a></span>(sim)</a></code></pre></div>
<p><img src="scale_invariant_trait_based_model_files/figure-html/demo_scale_model_sensitive-1.png" width="700"></p>
<p>The key for constructing these models is a special power-law relationship between body weight and density, which marine ecosystems are often observed to be near, after aggregating over species. The significance of the power law is that, in its neighbourhood, coexistence of species becomes easier to achieve. In fact, on the exact power-law, it has been proved that an infinite number of species coexist in a unicellular plankton model. Related numerical simulations using finite number of species support the proposition that coexistence of multiple species is easier to achieve near the power law.<br>
These properties readily extend to multicellular fish assemblages.</p>
<p>We build the alternative approach here in two steps. First, this section describes a background spectrum designed to bring the trait-based model (see <a href="trait_model.html">the section on trait-based models</a>) close to a scale-invariant form (see <a href="scale_invariant_trait_based_model.html#sec:steadyeq">the section on the steady state solution</a>), for which the steady-state is known analytically. For want of a better term, we call this model the <em>scale-invariant</em>, trait-based model, with the caveat that the model is close to, but not exactly, scale invariant.</p>
<p>Second, in <a href="scale_invariant_trait_based_model.html#sec:explicit">the section on implementing explicit species in a scale-invariant background</a>, these background species are replaced by foreground species with specified properties in a fish assemblage.</p>
</div>
<div id="scale-invariance" class="section level2">
<h2 class="hasAnchor">
<a href="#scale-invariance" class="anchor"></a>Scale invariance</h2>
<p>Dynamical systems with scale-invariant properties are not standard currency in ecology, and this subsection can be skipped. However the approach is underpinned by scale invariance with respect to body weight, so we briefly introduce some key concepts here. There is little more in this than allometric scalings of ecological rates with respect to body weight, for the most part familiar and widely documented in ecology.</p>
<div id="what-is-scale-invariance" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-scale-invariance" class="anchor"></a>What is scale invariance?</h3>
<p>Consider a species with some characteristic weight (maximum weight <span class="math inline">\(w_\infty\)</span> will do for the purpose), and with a density function <span class="math inline">\(N(w,t)\)</span> that has dynamics given by the McKendrick–von Foerster equation:</p>
<p><span class="math display">\[\begin{equation}
  \frac{\partial N(w,t)}{\partial t} + \frac{\partial g(w) N(w,t)}{\partial w} 
  = -\mu(w) N(w,t),
\end{equation}\]</span></p>
<p>Consider a second species with maximum weight <span class="math inline">\(cw_\infty,\)</span> where <span class="math inline">\(c\)</span> is a positive rescaling factor. Then the McKendrick–von Foerster equation would be scale-invariant, if the latter species had dynamics the same as the first when rescaled as <span class="math inline">\(c^{\lambda + 1} N(c w, c^{1-n} t),\)</span> for any <span class="math inline">\(c&gt;0\)</span>. Here <span class="math inline">\(\lambda\)</span> is the exponent of the plankton spectrum, and <span class="math inline">\(n\)</span> is the exponent for maximum food intake.</p>
<p>This rather delphic statement basically says that, under scale invariance, knowing the dynamics of one species is enough to know the dynamics of every species. Strictly speaking, it could only apply to the McKendrick–von Foerster equation if there was a continuum of maximum weights, with a species at every <span class="math inline">\(w_\infty &gt; 0\)</span>. Clearly, this cannot be the case in a multispecies spectrum with a finite set of species, because the <span class="math inline">\(w_\infty\)</span>s are typically separated by finite intervals, and the spectrum has fixed lower and upper boundaries, outside which there are no species. Therefore, a scale-invariant system is, at best, an idealisation of a size-spectrum model with a finite number of species.</p>
</div>
<div id="why-bother-with-scale-invariance" class="section level3">
<h3 class="hasAnchor">
<a href="#why-bother-with-scale-invariance" class="anchor"></a>Why bother with scale invariance?</h3>
<p>There is an ecological reason and a mathematical one. The ecological reason is that, in marine ecosystems, abundance (aggregated over species) as a function of body mass, is often observed to be quite close to a power law. The existence of this remarkable regularity, plus the fact that it promotes coexistence of species, supports the development of scale-invariant models.</p>
<p>The mathematical reason is that scale-invariant systems possess symmetries which make them easier to understand. For instance, the assumption of scale invariance in the system with a continuum of maximum weights allows an exact analytic expression for a steady state of the system to be derived. Although scale invariance cannot be met exactly in the system with a finite number of species, it can still guide the choice of parameter values that are likely to permit coexistence of species.</p>
<p>Note that we are not suggesting that real assemblages of fish species are at rest on an exact power-law. Rather we use scale invariance to construct <em>background</em> assemblages that facilitate coexistence of observed fish species (<em>foreground</em> species), without calling for strong stock-recruitment relationships.</p>
</div>
</div>
<div id="implementing-the-scale-invariant-model" class="section level2">
<h2 class="hasAnchor">
<a href="#implementing-the-scale-invariant-model" class="anchor"></a>Implementing the scale-invariant model</h2>
<p>Here we describe how to run the scale-invariant model, and make some comparisons with the trait-based model in <a href="trait_model.html">the section on the trait-based model.</a></p>
<p>To help set up a scale invariant trait-based model, there is a wrapper function, <code><a href="../reference/set_scaling_model.html">set_scaling_model()</a></code>. Like the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> and <code>set_tait_model()</code> functions described above, this function can take many arguments. Most of them have default values so you don’t need to worry about them for the moment. Now let us give an example of how to setup the scale-invariant trait-based model:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_scaling_model.html">set_scaling_model</a></span>(<span class="dt">no_sp =</span> <span class="dv">10</span>, <span class="dt">min_w_inf =</span> <span class="dv">10</span>, <span class="dt">max_w_inf =</span> <span class="fl">1e3</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                            <span class="dt">min_egg =</span> <span class="fl">1e-4</span>, <span class="dt">min_w_mat =</span> <span class="dv">10</span><span class="op">^</span>(<span class="fl">0.4</span>), </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                            <span class="dt">knife_edge_size =</span> <span class="dv">100</span>, <span class="dt">kappa =</span> <span class="fl">0.005</span>)</a></code></pre></div>
<pre><code>## Note: No gamma provided for some species, so using f0, h, beta, sigma, lambda and kappa to calculate it.</code></pre>
<p>The main parameters of interest are the number of the species in the model (<code>no_sp</code>), the minimum egg size (<code>min_egg</code>), the minimum maturity size of a species (<code>min_w_mat</code>) and the minimum and maximum asymptotic sizes (<code>min_w_inf</code>) and (<code>max_w_inf</code>) respectively. The egg, maturity and asymptotic sizes are spread evenly on a logarithmic scale. The Beverton-Holt stock recruitment relationship is turned off by default.</p>
<p>Once a <code>MizerParams</code> object has been created for the scale-invariant model, it can be run in the usual way:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params, <span class="dt">t_max=</span><span class="dv">5</span>, <span class="dt">effort =</span> <span class="dv">0</span>)</a></code></pre></div>
<p>We make a plot of the biomass over time as follows:</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_scale_sim-1.png" alt="A plot of time vs biomass for the scale invariant trait-based model with no fishing." width="700"><p class="caption">
A plot of time vs biomass for the scale invariant trait-based model with no fishing.
</p>
</div>
<p>One can see from the previous figure that the system is initiated very close to a steady state, and it is further attracted to the steady state without the need to impose any stock recruitment relationship (at least under default settings).</p>
<p>We can check that the steady state lies close to a power law by plotting the biomass densities of the different species, as well as their total, which evidently is close to the power law.</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_scale_simBS-1.png" alt="A plot of weight vs biomass density for the steady state of the scale invariant trait-based model with no fishing." width="700"><p class="caption">
A plot of weight vs biomass density for the steady state of the scale invariant trait-based model with no fishing.
</p>
</div>
</div>
<div id="subsec:bullets" class="section level2">
<h2 class="hasAnchor">
<a href="#subsec:bullets" class="anchor"></a>Details of changes to the trait-based model</h2>
<!--
Here we document the changes made to the Mizer software tool described in 
Section~\@ref(sec:principles), in order to generate species assemblages close to 
scale invariance.  
-->
<p>The new model is similar to the original <a href="trait_model.html">trait-based model</a>, but includes some modifications and restrictions to get assemblages that are close to scale invariance. The changes are as follows.</p>
<ul>
<li><p>For the model to be scale invariant, the exponent of metabolic intake <span class="math inline">\(n\)</span> needs to be equal to the exponent <span class="math inline">\(p\)</span> of metabolic loss.</p></li>
<li><p>Scale invariance also requires that the exponent of the plankton spectrum <span class="math inline">\(\lambda\)</span> must satisfy the relation <span class="math inline">\(\lambda = 2-n+q\)</span>, where <span class="math inline">\(n\)</span> is the exponent of metabolic intake and <span class="math inline">\(q\)</span> is the exponent of the volumetric search rate.</p></li>
<li><p>Feeding depends on prey body size, but not on prey species identity, so <span class="math inline">\(\theta_{ij}=1\)</span> for all <span class="math inline">\(i,j\)</span>. Note however that the feeding preference function <span class="math inline">\(\phi_i(w_p/w)\)</span> already has scale invariance built into it, because predation depends on the ratio of prey to predator weight. Thus no modification to growth and mortality caused by predation is needed in moving to scale invariance.</p></li>
<li><p>We assume that the proportion of energy allocated to reproduction <span class="math inline">\(\psi_i(w)\)</span> is given by the step-like function <span class="math display">\[\begin{equation}
 \psi_i(w)=\begin{cases}
 0 &amp; \text{if } w&lt;w_{m.i}\\
 \left(\frac{w}{w_{\infty.i}}\right)^{1-n} &amp; \text{otherwise}
 \end{cases}
 \end{equation}\]</span> This can be achieved by taking the default equation described in <a href="model_description.html#sec:invest">the section on investment into reproduction</a>, and replacing the number 10 within with <span class="math inline">\(\infty.\)</span> This is not a requirement for scale invariance; the assumption was made for the mathematical reason that it is then possible to get a closed-form expression for the steady state.</p></li>
<li><p>Scale invariance requires egg weight to be a fixed fraction of maximum weight. It is therefore indexed by species <span class="math inline">\(w_{0,i}\)</span>, rather than taking a single size <span class="math inline">\(w_0\)</span>. Egg size does vary over about two orders of magnitude in teleosts, but there is evidence that at least the larger teleosts are unusual in marine systems in lacking a scaling relationship between egg wight and adult weight. Scale invariance of egg weight should therefore be seen as a mathematical restriction required to generate the scale-invariant background assemblage, in so far as the background comprises teleost fish.</p></li>
<li><p>A stock-recruitment relationship is not required to create a steady state in the scale-invariant, trait-based model.<br>
However, a stock-recruitment relationship can be included in the scale-invariant trait-based model by setting the value of <code>r_fac</code>. Here <code>r_fac</code> equals the maximum recruitment <span class="math inline">\(R_{max.i}\)</span> divided by the actual recruitment <span class="math inline">\(R_i\)</span> at our steady state. By default the stock-recruitment relationship is turned off, by setting <code>r_fac</code> to go to infinity. This has the effect of also making <span class="math inline">\(R_{max.i}\rightarrow \infty\)</span>, and so the typically assumed Beverton-Holt stock-recruitment equation $ R_i = R_{.i} $ is effectively replaced with the simple equation <span class="math inline">\(R_i = R_{p.i}.\)</span></p></li>
<li><p>Beyond the upper limit of body weight. The total mortality needs to scale with body weight. In practice, body weight always has an upper limit in a real ecosystem, and predation mortality goes to zero as this limit is approached. Some compensation is needed for this in the background mortality. Thus, rather than determining the background mortality using the equation<br><span class="math inline">\(\mu_{b.i} = \mu_0 W_i^{n-1},\)</span> we instead use the more intricate expression: <span class="math inline">\(\mu_{b.i}(w) = \max \{ \mu_0 w^{n-1} - \mu_{p.i}(w),0 \}.\)</span> Essentially this term represents the predation mortality which would be induced by predators beyond the upper limit of body sizes explicitly modelled, under the assumption that the abundance of such predators continue the scale invariant pattern. mortality, given by $ _{p.i}(w_p) = <em>j </em>{ji} _j(w_p/w) (1-f_j(w)) _j w^q N_j(w) , dw$, where the abundance <span class="math inline">\(N\)</span> is the abundance at our steady state. This is done to ensure that the total mortality rate on explicitly modeled species is <span class="math inline">\(\mu_0 w^{n-1}\)</span> which scales with weight in the way required for scale invariance.</p></li>
<li><p>The plankton spectrum extends from the smallest weight at which an explicitly modeled fish may eat. We define the carrying capacity <span class="math inline">\(c_p(w)\)</span> of the plankton so when our system is at steady state, the combination of the plankton spectrum and the aggregate abundance of the explicitly modeled species is the power law <span class="math inline">\(\kappa w^{-\lambda}.\)</span> An expression for how we set <span class="math inline">\(c_p(w)\)</span> within the scale-invariant trait-based model is given by the equation <span class="math display">\[\begin{equation} 
c_{p} (w)= \min \left\{ \left(1+\frac{\mu_p(w)}{r_0 w^{p-1}} \right)\left( \kappa w^{-\lambda} - \sum_i N_i(w) \right),0\right\},
\end{equation}\]</span> or is equal to the power law <span class="math inline">\(\kappa w^{-\lambda}\)</span> within the appropriate size range (i.e., for <span class="math inline">\(w\leq\min\{w_{m.i}\}\)</span>), <span class="math inline">\(w\)</span> approaches <span class="math inline">\(\min\{w_{m.i}\}\)</span> from below, the carrying capacity of the plankton declines to zero.</p></li>
<li><p>By default the scale-invariant trait-based model is initialized at a steady state, see <a href="scale_invariant_trait_based_model.html#sec:steadyeq">the section on the steady state solution</a>, (provided no fishing is being performed), whereas the original trait based model is not initialized near its steady state.</p></li>
</ul>
</div>
<div id="sec:explicit" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:explicit" class="anchor"></a>Implementing explicit species in a scale-invariant background</h1>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>We have seen that using strong stock recruitment relationships, as implemented within the models discussed in <a href="trait_model.html">the section on the trait-based model</a> and <a href="a_multispecies_model_of_the_north_sea.html">the section on the North Sea model</a> can lead to scenarios where the stock levels are unrealistically insensitive to changes in the environment. In order to fix this issue we want to create a model where species of interest can co-exist and interact without imposing a strong stock recruitment relationship. The key to our approach is to use species from the scale-invariant trait based model as a type of background or substrate, into which the heterogeneous species of specific interest (the <em>foreground species</em>) can added.</p>
<p>We begin with only the scale-invariant background, which is setup close to a steady state by the <code><a href="../reference/set_scaling_model.html">set_scaling_model()</a></code> command. We add new species using the <code><a href="../reference/addSpecies.html">addSpecies()</a></code> command, in such a way that the resulting system remains close to a steady state. To achieve this we lower the abundances of the background species in our candidate steady state to compensate for the addition of the new foreground species, so that the background species still have the same food levels, and growth rates, as they did in the original system. We also choose the abundance curve for the newly added species so that it will be time-invariant under the McKendrick–von Foerster equation. Additional steps are taken to fine tune the resulting state to make sure that the background species are close to time-invariant under the McKendrick–von Foerster equation, and that the quantity of fish growing up from the egg size is balanced by the rate of egg production.</p>
</div>
<div id="adding-a-foreground-species-to-a-scale-invariant-background" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-a-foreground-species-to-a-scale-invariant-background" class="anchor"></a>Adding a foreground species to a scale-invariant background</h2>
<p>Initially, when we start with the scale-invariant trait-based model, these species are organized, so that their aggregate abundance follows a power-law. This can be done using the <code><a href="../reference/set_scaling_model.html">set_scaling_model()</a></code> command as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">params_bg  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/setBackground.html">setBackground</a></span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="kw"><a href="../reference/set_scaling_model.html">set_scaling_model</a></span>(<span class="dt">no_sp =</span> <span class="dv">10</span>, <span class="dt">no_w =</span> <span class="dv">400</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                    <span class="dt">min_w_inf =</span> <span class="dv">10</span>, <span class="dt">max_w_inf =</span> <span class="fl">1e5</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                    <span class="dt">min_egg =</span> <span class="fl">1e-4</span>, <span class="dt">min_w_mat =</span> <span class="dv">10</span><span class="op">^</span>(<span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                    <span class="dt">knife_edge_size =</span> <span class="ot">Inf</span>, <span class="dt">kappa =</span> <span class="dv">10000</span>,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                    <span class="dt">lambda =</span> <span class="fl">2.08</span>, <span class="dt">f0 =</span> <span class="fl">0.6</span>, <span class="dt">h =</span> <span class="dv">34</span>)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">)</a></code></pre></div>
<pre><code>## Note: No gamma provided for some species, so using f0, h, beta, sigma, lambda and kappa to calculate it.</code></pre>
<pre><code>## Note: Negative plankton abundances</code></pre>
<pre><code>## Note: Negative plankton abundance values overwritten with zeros</code></pre>
<pre><code>## Note: Negative background mortality rates overwritten with zeros</code></pre>
<p>Let us introduce a species which we are interested in modelling explicitly into this background using our <code><a href="../reference/addSpecies.html">addSpecies()</a></code> command. For the sake of example we shall introduce a red mullet, we start by specifying its parameters using a dataframe with a single row:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">species_params &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">species =</span> <span class="st">"Mullet"</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">w_min =</span> <span class="fl">0.001</span>, </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">w_inf =</span> <span class="fl">173.2425</span>, </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="dt">w_mat =</span> <span class="fl">15.14863</span>, </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">beta =</span> <span class="dv">283</span>, </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="dt">sigma =</span> <span class="fl">1.8</span>, </a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  <span class="dt">z0 =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">  <span class="dt">alpha =</span> <span class="fl">0.6</span>, </a>
<a class="sourceLine" id="cb11-10" data-line-number="10">  <span class="dt">erepro =</span> <span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb11-11" data-line-number="11">  <span class="dt">sel_func =</span> <span class="st">"sigmoid_length"</span>, </a>
<a class="sourceLine" id="cb11-12" data-line-number="12">  <span class="dt">gear =</span> <span class="st">"sigmoid_gear"</span>,</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">  <span class="dt">l25 =</span> <span class="fl">13.17291</span>,</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">  <span class="dt">l50 =</span> <span class="fl">15.48</span>,</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">  <span class="dt">k =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  <span class="dt">k_vb =</span> <span class="fl">0.6</span>,</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  <span class="dt">a =</span> <span class="fl">0.0085</span>,</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">  <span class="dt">b =</span> <span class="fl">3.11</span>,</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">  <span class="dt">gamma =</span> <span class="fl">0.0017</span>,</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">  <span class="dt">h =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">  <span class="dt">linecolour =</span> <span class="st">"red"</span>,</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">  <span class="dt">linetype =</span> <span class="st">"solid"</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23">)</a></code></pre></div>
<p>Foreground species of specific interest can be introduced into our background using the following command:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">params_bg_m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/addSpecies.html">addSpecies</a></span>(params_bg, species_params, <span class="dt">SSB =</span> <span class="dv">2800</span>, <span class="dt">effort=</span><span class="fl">0.4</span>, </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                <span class="dt">rfac =</span> <span class="fl">1.01</span>)</a></code></pre></div>
<pre><code>## Note: The following species have feeding kernels that extend below the smallest plankton size specified by min_w_pp: Mullet</code></pre>
<p>This code creates a new <code>MizerParams</code> object containing the original background species and the new foreground species, mullet. The <code><a href="../reference/addSpecies.html">addSpecies()</a></code> command attempts to construct a new approximate steady state (<code>params_out@initial_n</code>) including the new species.</p>
<p>The stock recruitment relationship can be controlled by setting the value of <code>r_fac</code>, as described in <a href="scale_invariant_trait_based_model.html#subsec:bullets">the section about changes to the trait-based model.</a></p>
<p>We can perform a simulation with our new system, including the mullet, in the usual way:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_bg_m, <span class="dt">t_max =</span> <span class="dv">25</span>, <span class="dt">effort =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<p>We can see from the resulting plot of time vs biomass that the system is initiated close to a steady state:</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_mullet_sim-1.png" alt="Example plot of time vs biomass for the scale invariant trait-based model plus mullet." width="700"><p class="caption">
Example plot of time vs biomass for the scale invariant trait-based model plus mullet.
</p>
</div>
<p>We can also visualize the relative abundances of the different species with the following command:</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_mullet_sim2-1.png" alt="Example plot of weight vs abundance for the scale invariant trait-based model plus mullet, in the final state of our simulation." width="700"><p class="caption">
Example plot of weight vs abundance for the scale invariant trait-based model plus mullet, in the final state of our simulation.
</p>
</div>
</div>
<div id="adding-another-species" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-another-species" class="anchor"></a>Adding another species</h2>
<p>In practical fisheries science one will have several species that one wishes to model explicitly. Further foreground species can be added into our system by repeated use of the <code><a href="../reference/addSpecies.html">addSpecies()</a></code> command. Let us demonstrate this by adding hake into our system with background and mullet. We start by specifying the data for the hake:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">species_params &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="dt">species =</span> <span class="st">"Hake"</span>,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  <span class="dt">w_min =</span> <span class="fl">0.001</span>, </a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  <span class="dt">w_inf =</span> <span class="fl">4174.194</span>, </a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  <span class="dt">w_mat =</span> <span class="fl">183.5169</span>, </a>
<a class="sourceLine" id="cb15-6" data-line-number="6">  <span class="dt">beta =</span> <span class="fl">11.02318</span>, </a>
<a class="sourceLine" id="cb15-7" data-line-number="7">  <span class="dt">sigma =</span> <span class="fl">1.1</span>, </a>
<a class="sourceLine" id="cb15-8" data-line-number="8">  <span class="dt">z0 =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">  <span class="dt">alpha =</span> <span class="fl">0.6</span>, </a>
<a class="sourceLine" id="cb15-10" data-line-number="10">  <span class="dt">erepro =</span> <span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb15-11" data-line-number="11">  <span class="dt">sel_func =</span> <span class="st">"sigmoid_length"</span>, </a>
<a class="sourceLine" id="cb15-12" data-line-number="12">  <span class="dt">gear =</span> <span class="st">"sigmoid_gear"</span>,</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">  <span class="dt">l25 =</span> <span class="fl">16.09244</span>,</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">  <span class="dt">l50 =</span> <span class="fl">16.6</span>,</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">  <span class="dt">k =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">  <span class="dt">k_vb =</span> <span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb15-17" data-line-number="17">  <span class="dt">a =</span> <span class="fl">0.0046</span>,</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">  <span class="dt">b =</span> <span class="fl">3.12</span>,</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">  <span class="dt">gamma =</span> <span class="fl">0.003</span>,</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">  <span class="dt">h =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">  <span class="dt">linecolour =</span> <span class="st">"blue"</span>,</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">  <span class="dt">linetype =</span> <span class="st">"solid"</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23">)</a></code></pre></div>
<p>Now we add the hake into our system:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">params_bg_m_h &lt;-<span class="st"> </span><span class="kw"><a href="../reference/addSpecies.html">addSpecies</a></span>(params_bg_m, species_params, <span class="dt">SSB =</span> <span class="dv">1200</span>,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">                            <span class="dt">effort=</span><span class="fl">0.4</span>, <span class="dt">rfac =</span> <span class="fl">1.01</span>)</a></code></pre></div>
<pre><code>## Note: The following species have feeding kernels that extend below the smallest plankton size specified by min_w_pp: Mullet</code></pre>
<p>We visualize the initial condition, close to steady state using the following command:</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_mullet_hake_spectra-1.png" alt="A plot of weight vs biomass density for the near steady state created by adding mullet and hake to a scale-invariant background." width="700"><p class="caption">
A plot of weight vs biomass density for the near steady state created by adding mullet and hake to a scale-invariant background.
</p>
</div>
<p>To see that this is close to a steady state we shall evolve the system and show how biomass changes over time:</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_mullet_hake_biomass-1.png" alt="A plot of time vs biomass showing our system with background species, mullet and hake,  evolving to a nearby steady state." width="700"><p class="caption">
A plot of time vs biomass showing our system with background species, mullet and hake, evolving to a nearby steady state.
</p>
</div>
<p>The <code><a href="../reference/steady.html">steady()</a></code> command can be used to fine tune the initial condition to be very close to a steady state:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">params_bg_m_h2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/steady.html">steady</a></span>(params_bg_m_h, <span class="dt">effort =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<pre><code>## Steady state was reached after  12 years.</code></pre>
<p>This results in a a configuration very close to a steady state, as we can see by evolving the system and plotting how biomass changes over time:</p>
<div class="figure">
<img src="scale_invariant_trait_based_model_files/figure-html/plot_mullet_hake_biomass_steady-1.png" alt="A plot of time vs biomass showing our system with background species, mullet and hake evolving from our fine tuned nearby steady state." width="700"><p class="caption">
A plot of time vs biomass showing our system with background species, mullet and hake evolving from our fine tuned nearby steady state.
</p>
</div>
</div>
</div>
<div id="sec:appendix" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:appendix" class="anchor"></a>Appendix</h1>
<p>In this section we give some of the more technical details behind the scale-invariant model, and how it is implemented in mizer.</p>
<div id="sec:steadyeq" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:steadyeq" class="anchor"></a>A steady state solution</h2>
<p>Assuming scale invariance allows us to find the following exact analytic expression for a steady state. This corresponds to the following form for the abundance within the discrete approximation to the scale-invariant system implemented by mizer: <span class="math display">\[\begin{equation}
% {#eq:steady}
N_i (w,t) = H \left(\frac{w_{0,1}}{w_{0,i}}\right)^{\lambda} \left(\frac{w_{0,i}}{w}\right)^{\mu _0/\hbar} \hbar^{-1} w^{-n} M_i (w)
\end{equation}\]</span> where <span class="math display">\[\begin{equation} M_i (w)=
   \begin{cases}
      1, &amp; \text{if}\ w&lt;w_{m.i} \\
      \frac{1}{\left(1-\left(\frac{w}{w_{\infty.i}}\right)^{1-n}\right)}\left(\frac{1-\left(\frac{w}{w_{\infty.i}}\right)^{1-n}}{1-\left(\frac{w_{m.i}}{w_{\infty.i}}\right)^{1-n}}\right)^{\frac{1}{1-n}\left(\frac{\mu_{0}}{\hbar}\right)}, &amp; \text{otherwise}
    \end{cases}
\end{equation}\]</span> and <span class="math display">\[\begin{equation}
% {#eq:mu0}
 \mu_0 = (1 - f_0)  \sqrt{2 \pi} \kappa  \gamma  \sigma \beta ^{n - 1} \exp\left(\frac{\sigma ^ 2  (n - 1) ^ 2} {2}\right). 
 \end{equation}\]</span> As the number of species becomes large we have that <span class="math inline">\(\sum_i N_i (w)\)</span> is approximately proportional to <span class="math inline">\(\kappa w^{-\lambda},\)</span> <span class="math inline">\(\forall w \in [\min \{w_{m.i} \} , \max \{w_{m.i} \}].\)</span> The constant <span class="math inline">\(H\)</span> is chosen so that <span class="math inline">\(\sum_i N_i (w)\)</span> is approximately equal to <span class="math inline">\(\kappa w^{-\lambda}\)</span> <span class="math inline">\(\forall w \in [\min \{w_{m.i} \} , \max \{w_{m.i} \}].\)</span> This steady state is special because it is invariant under the type of rescaling described above. We also have to choose parameters in such a way that <span class="math inline">\(R_{p.i} = \frac{\epsilon}{2 w_0} \int N_i(w) E_{r.i}(w) \psi_i(w) \, dw\)</span> holds. However, if it holds for one species, then it holds for all species due to scale-invariance. Although the original trait based model had a similar level of simplicity, and a partial description of something like a steady state was possible, however careful study of the trait-based model reveals that it was in fact impossible to setup such a system so that the average number of offspring produced over an individuals lifespan is one, for each species, without imposing a stock recruitment relationship. This is part of the reason why stock recruitment relationships were imposed on previous models. However we believe that the stock recruitment relationships should emerge out of the life histories which size spectrum models claim to be able to model, rather than being imposed for outside the model.</p>
</div>
<div id="background-mortality-in-the-scale-invariant-model" class="section level2">
<h2 class="hasAnchor">
<a href="#background-mortality-in-the-scale-invariant-model" class="anchor"></a>Background mortality in the scale invariant model</h2>
<p>We arrived at our expression for <span class="math inline">\(\mu_b(w)\)</span> by considering that in the steady state of continuous scale-invariant trait based model, the total mortality rate of of individuals is given by the power-law <span class="math inline">\(\mu_0 w^{n-1}\)</span>. In the finite system in mizer, individuals are only modelled up to a given size, and so we define <span class="math inline">\(\mu_b(w)\)</span> as the difference between the desired power-law mortality rate, and the predation rate exhibited by explicitly modeled species at our steady state:</p>
<p><span class="math display">\[\begin{equation}
%  {#eq:newmub}
  \mu_{b.i}(w) = \max \{ \mu_0 w^{n-1} - \mu_{p.i}(w),0 \}
  \end{equation}\]</span> where equations for <span class="math inline">\(\mu_0\)</span> and the predation mortality <span class="math inline">\(\mu_{p.i} (w)\)</span> are in <a href="scale_invariant_trait_based_model.html#sec:steadyeq">the section on the steady state solution.</a> This is done so that (provided we choose parameters so <span class="math inline">\(\mu_{b.i}(w) = \mu_0 w^{n-1} - \mu_{p.i}(w)\geq 0.\)</span>) ) we ensure that the total mortality rate on explicitly modeled species is <span class="math inline">\(\mu_0 w^{n-1},\)</span> which scales with weight in the way required for scale invariance.</p>
</div>
<div id="plankton-in-the-scale-invariant-model" class="section level2">
<h2 class="hasAnchor">
<a href="#plankton-in-the-scale-invariant-model" class="anchor"></a>Plankton in the scale invariant model</h2>
<p>We define the carrying capacity <span class="math inline">\(c_p(w)\)</span> of the plankton so when our system is at steady state, the combination of the plankton spectrum and the aggregate abundance of the explicitly modeled species is the power law <span class="math inline">\(\kappa w^{-\lambda}.\)</span> This is achieved choosing the carrying capacity of the plankton to be <span class="math display">\[\begin{equation} 
% {#eq:cp}
c_{p} (w)= \min \left\{ \left(1+\frac{\mu_p(w)}{r_0 w^{p-1}} \right)\left( \kappa w^{-\lambda} - \sum_i N_i(w) \right),0\right\}
\end{equation}\]</span> Note that, much like in the background mortality term, we require that the aggregate abundance <span class="math inline">\(\sum_i N_i(w)\)</span> is less than or equal to the power law $w^{-} $ within the appropriate size range (i.e., for <span class="math inline">\(w\leq\min\{w_{m.i}\}\)</span>), so that we do not have to use our <span class="math inline">\(\min\{ *, 0\}\)</span> operation to rewrite negative entries.</p>
</div>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>Finlay Scott would like to thank the Cefas Seedcorn Project DP266 and the Defra project MF1225 for supporting this work. This project has received funding from the European Union’s Horizon 2020 Research and Innovation programme under Grant Agreement No 634495 (MINOUW).</p>
<p>The work of Gustav Delius, Richard Southwell and Richard Law on updating mizer was funded by the European Commission Horizon 2020 Research and Innovation Programme under Grant Agreement No. 634495 for the project <a href="http://minouw-project.eu/">MINOUW</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sec:scale_invariant_trait_based_model">Introduction</a></li>
      <li>
<a href="#scale-invariance">Scale invariance</a><ul class="nav nav-pills nav-stacked">
<li><a href="#what-is-scale-invariance">What is scale invariance?</a></li>
      <li><a href="#why-bother-with-scale-invariance">Why bother with scale invariance?</a></li>
      </ul>
</li>
      <li><a href="#implementing-the-scale-invariant-model">Implementing the scale-invariant model</a></li>
      <li><a href="#subsec:bullets">Details of changes to the trait-based model</a></li>
      <li>
<a href="#sec:explicit">Implementing explicit species in a scale-invariant background</a><ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#adding-a-foreground-species-to-a-scale-invariant-background">Adding a foreground species to a scale-invariant background</a></li>
      <li><a href="#adding-another-species">Adding another species</a></li>
      </ul>
</li>
      <li>
<a href="#sec:appendix">Appendix</a><ul class="nav nav-pills nav-stacked">
<li><a href="#sec:steadyeq">A steady state solution</a></li>
      <li><a href="#background-mortality-in-the-scale-invariant-model">Background mortality in the scale invariant model</a></li>
      <li><a href="#plankton-in-the-scale-invariant-model">Plankton in the scale invariant model</a></li>
      </ul>
</li>
      <li><a href="#acknowledgements">Acknowledgements</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Finlay Scott, Julia Blanchard, Ken Andersen, Gustav Delius.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'de91577b2f58755afaa137388a513a88',
    indexName: 'mizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
