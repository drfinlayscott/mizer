<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Developer Guide • mizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Developer Guide">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mizer.html">Get Started</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gustavdelius/mizer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Developer Guide</h1>
            
            <h4 class="date">2019-03-15</h4>
      
      <small class="dont-index"><a href="https://github.com/gustavdelius/mizer/edit/master/vignettes/developer_vignette.Rmd">Edit this page.  </a> Source: <a href="https://github.com/gustavdelius/mizer/blob/master/vignettes/developer_vignette.Rmd"><code>vignettes/developer_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>developer_vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette is for you if you need to extend mizer to meet the needs of your research project. You will already have read the mizer model description in <code><a href="../articles/model_description.html">vignette("model_description")</a></code> and thus be familiar with what mizer can do out of the box. You now want to implement the extension or modification of the model required for your research, and for that you need to dive into the internal workings of mizer. This vignette is meant to make that as easy as possible.</p>
<p>The first thing you should do, even before reading this vignette, is to go to <a href="https://github.com/sizespectrum/mizer/issues" class="uri">https://github.com/sizespectrum/mizer/issues</a> and create a new “issue”" to share your ideas and plans with the mizer community. You may get back valuable feedback and advice. Another way to get in touch with the mizer community is via the <a href="https://groups.google.com/forum/#!forum/size-spectrum-models">size-spectrum modelling Google group</a>.</p>
</div>
<div id="setting-up-working-environment" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-up-working-environment" class="anchor"></a>Setting up working environment</h1>
<p>In this section we describe how to set up your working environment to allow you to easily work with the mizer code. Much of it you may already have in place, so feel free to skip ahead.</p>
<div id="installing-r-rstudio-devtools" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-r-rstudio-devtools" class="anchor"></a>Installing R, RStudio, devtools</h2>
<p>Mizer is compatible with R versions 3.1 and later. If you still need to <a href="https://cran.r-project.org/">install R</a>, simply install the latest version. This vignette was prepared with R version 3.5.3 (2019-03-11).</p>
<p>This guide assumes that you will be using RStudio to work with R. There is really no reason not to use RStudio and it makes a lot of things much easier. RStudio develops rapidly and adds useful features all the time and so it pays to upgrade to the <a href="https://www.rstudio.com/products/rstudio/download/preview/">latest version</a> frequently. This guide was written with version 1.2.1268.</p>
<p>To work with R packages as a developer, you will need to <a href="https://support.rstudio.com/hc/en-us/articles/200486498-Package-Development-Prerequisites">install additional tools</a>. Once you have these in place, you should install the devtools package with</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"devtools"</span>)</a></code></pre></div>
<p>You are now all set to develop R packages, and <a href="https://support.rstudio.com/hc/en-us/articles/200486488-Developing-Packages-with-RStudio">RStudio makes this extra easy</a>. There is even a cheat sheet for package development accessible from the Help menu in RStudio.</p>
</div>
<div id="installing-git" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-git" class="anchor"></a>Installing git</h2>
<p>In case git is not already installed on your system, you need to <a href="http://happygitwithr.com/install-git.html">install it</a>. You do not need to install any GUI for git because RStudio has <a href="https://support.rstudio.com/hc/en-us/articles/200532077-Version-Control-with-Git-and-SVN">built-in support for git</a>. A good place to learn about using git and github is <a href="http://r-pkgs.had.co.nz/git.html">this chapter</a> in the guide by Hadley on R package development.</p>
</div>
<div id="forking-mizer-from-github" class="section level2">
<h2 class="hasAnchor">
<a href="#forking-mizer-from-github" class="anchor"></a>Forking mizer from github</h2>
<p>Mizer is developed using the version control system <em>git</em> and the code is hosted on github. To work with the code you will create your own git repository with a copy of the mizer code.</p>
<p>Go to <a href="https://github.com/sizespectrum/mizer" class="uri">https://github.com/sizespectrum/mizer</a> and fork it into your own repository. Then create a version control new project in Rstudio, and indicate your depository url.</p>
<p>You will want to set up RStudio so that it automatically builds the documentation using roxygen. * Go to Build -&gt; Configure Build Tools, tick the checkbox “Generate documentation with roxygen”.</p>
<p>On the “Git” tab select the “dev” branch. This contains the latest development code for mizer.</p>
<p>To run this code go to the “Build” tab in RStudio and click on “Install and Restart”. This builds and loads the mizer package based on this development code.</p>
</div>
</div>
<div id="finding-your-way-around-the-mizer-code" class="section level1">
<h1 class="hasAnchor">
<a href="#finding-your-way-around-the-mizer-code" class="anchor"></a>Finding your way around the mizer code</h1>
<p>Mizer is organised in a modular fashion. It is separated into setup functions, simulation functions, and analysis and plotting functions. These will be described below after we have introduced the mizer model.</p>
<p>The core of mizer is the <code><a href="../reference/project.html">project()</a></code> function that runs a simulation of the size-spectrum model. It takes a specification of the model contained in an object of type <code>MizerParams</code> and returns the results of the simulation in an object of type <code>MizerSim</code>.</p>
<p>There are several different methods for setting up a <code>MizerParams</code> object for specifying various concrete models. These setup functions make various simplifying assumptions about the model parameters to reduce the amount of information that needs to be specified. This usually takes the form of assuming allometric scaling laws. Below we will first describe the most general size spectrum model handled by mizer before describing the specialisations for which mizer has special setup functions.</p>
<p>There are many functions for analysing and plotting the results of a mizer simulation contained in a <code>MizerSim</code> object.</p>
<p>The <code>MizerParams</code> and <code>MizerSim</code> objects are S4 objects, meaning that their slots are rigorously defined and are accessed with the ‘@’ notation. You do not need to learn about S4 classes in order to understand the mizer code, because the code avoids using S4 methods. In the presentation below we assume that the <code>MizerParams</code> object is called <code>params</code> and the <code>MixerSim</code> object is called <code>sim</code>.</p>
<div id="the-mizerparams-object" class="section level2">
<h2 class="hasAnchor">
<a href="#the-mizerparams-object" class="anchor"></a>The MizerParams object</h2>
<p>An object of class ‘MizerParams’ holds all the information needed for the ‘project()’ method to simulate a model.</p>
<!--

## The project methods

## The MizerSim object

## Shiny apps

# Developer guidelines

## Collaborating on Github

-->
</div>
<div id="coding-style" class="section level2">
<h2 class="hasAnchor">
<a href="#coding-style" class="anchor"></a>Coding style</h2>
<p><a href="https://google.github.io/styleguide/Rguide.xml">Google’s R Style Guide</a> <a href="http://style.tidyverse.org/">The tidyverse style guide</a></p>
</div>
<div id="always-write-tests-for-your-code" class="section level2">
<h2 class="hasAnchor">
<a href="#always-write-tests-for-your-code" class="anchor"></a>Always write tests for your code</h2>
<p>We use <a href="http://testthat.r-lib.org/">testthat</a> and <a href="https://rstudio.github.io/shinytest/articles/shinytest.html">shinytest</a>. The test are in the directory <code>tests/testthat</code>.</p>
<p>Some tests compare the results of calculations to the results the code gave in the past, using the <code>expect_known_value()</code> test. The past values are stored in tests/testthat/values. If one of the tests gives a value that is different from the stored value, then the test throws an error <em>and</em> overwrites the stored value with the new result. The second time the test is run, it then no longer fails. Luckily the original values will still be in the git repository. So after you think you have fixed the error that led to the wrong result, you should revert to the old stored values before re-running the test. Reverting to the old stored values is easy: Just go to the Git tab in RStudio, select the changed files in tests/testthat/values (select, not tick), then right-click and choose Revert.</p>
<p>It may be that the change in the result of a calculation is intended, perhaps because your new code is more accurate than the old code. If you are 100% certain of this, but only then, should you commit the changed files in tests/testthat/values, so that these new values form the basis of future comparison tests.</p>
</div>
<div id="rebuild-package-after-altering-code" class="section level2">
<h2 class="hasAnchor">
<a href="#rebuild-package-after-altering-code" class="anchor"></a>Rebuild package after altering code</h2>
<p>If you make a change to mizer’s code you will have to rebuild the package after you are done. In RStudio this can be done by clicking on the <em>Build</em> tab at the top right and clicking <em>Install and Restart</em>. To be sure that the changes have taken proper effect it may also help to clean the environment and/or restart RStudio.</p>
<p>To be sure that the package builds properly, make sure that the Roxygen2 package is properly installed, and click the <em>More</em> dropdown, on the <em>Build</em> tab, and click <em>Configure Build Tools</em> and tick <em>Use devtools package functions if available</em> and <em>Generate documentation with Roxygen</em>, and click <em>Configure</em> and under <em>Automatically roxygenize when running:</em> tick <em>Build &amp; Reload</em>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#setting-up-working-environment">Setting up working environment</a><ul class="nav nav-pills nav-stacked">
<li><a href="#installing-r-rstudio-devtools">Installing R, RStudio, devtools</a></li>
      <li><a href="#installing-git">Installing git</a></li>
      <li><a href="#forking-mizer-from-github">Forking mizer from github</a></li>
      </ul>
</li>
      <li>
<a href="#finding-your-way-around-the-mizer-code">Finding your way around the mizer code</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-mizerparams-object">The MizerParams object</a></li>
      <li><a href="#coding-style">Coding style</a></li>
      <li><a href="#always-write-tests-for-your-code">Always write tests for your code</a></li>
      <li><a href="#rebuild-package-after-altering-code">Rebuild package after altering code</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Finlay Scott, Julia Blanchard, Ken Andersen, Gustav Delius.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'de91577b2f58755afaa137388a513a88',
    indexName: 'mizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
