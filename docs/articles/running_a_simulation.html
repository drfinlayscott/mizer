<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running A Simulation • mizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Running A Simulation">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mizer.html">Get Started</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gustavdelius/mizer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Running A Simulation</h1>
            
      
      <small class="dont-index"><a href="https://github.com/gustavdelius/mizer/edit/master/vignettes/running_a_simulation.Rmd">Edit this page.  </a> Source: <a href="https://github.com/gustavdelius/mizer/blob/master/vignettes/running_a_simulation.Rmd"><code>vignettes/running_a_simulation.Rmd</code></a></small>
      <div class="hidden name"><code>running_a_simulation.Rmd</code></div>

    </div>

    
    
<div id="sec:projection" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:projection" class="anchor"></a>Introduction</h2>
<p>In the <a href="community_model.html">community</a> and <a href="trait_model.html">trait-based</a> models, we used the <code><a href="../reference/project.html">project()</a></code> method to perform simple simulations where the fishing effort was held constant throughout the duration of the simulation. In the trait-based model example, we also looked at how the effort for different gears could be specified. In this section we take a detailed look at how the <code><a href="../reference/project.html">project()</a></code> method works and the different ways in which effort and time can be set up. This will allow us to run more general systems like the <a href="multispecies_model.html">multispecies model.</a></p>
<p>In <code>mizer</code>, simulations are performed using the <code><a href="../reference/project.html">project()</a></code> method. This method takes a <code>MizerParams</code> object and projects it forward through time, starting from an initial population abundance and with a pre-determined fishing effort pattern.</p>
<p>Running a projection with <code><a href="../reference/project.html">project()</a></code> requires various arguments:</p>
<p>A <code>MizerParams</code> object -The model parameters (see previous section);</p>
<p>Fishing effort -The fishing effort of each gear through time;</p>
<p>Initial population -The initial abundances of the stocks and the plankton spectrum;</p>
<p>Time arguments -Arguments to control the time of the simulation, including the simulation time step, the length of the simulation and how frequently the output is stored.</p>
<p>The help page for <code><a href="../reference/project.html">project()</a></code> describes the arguments in more detail.</p>
<p>The <code>MizerParams</code> class was explored in the previous section. In this section we will look at the other arguments and use examples to perform some simple projections.</p>
<p>The object returned from calling <code><a href="../reference/project.html">project()</a></code> is of class <code>MizerSim</code>. This contains the abundances of the species in the model by time and size. It is described fully in <a href="running_a_simulation.html#sec:mizersim">the section on running project().</a></p>
</div>
<div id="sec:time_arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:time_arguments" class="anchor"></a>The time arguments</h2>
<p>There are three arguments that control time in the <code><a href="../reference/project.html">project()</a></code> method: <code>dt</code>, <code>t_max</code> and <code>t_save</code>. All of them have default values.</p>
<p><code>t_max</code> determines the maximum time of the simulation, i.e. how long the projection is run for. The default value for <code>t_max</code> is 100.</p>
<p><code>dt</code> is the time step used by the numerical solver in <code><a href="../reference/project.html">project()</a></code>. This is the time step on which the model operates. The smaller the value, the longer the model will take to run. However, sometimes it is necessary to use a small value to avoid numerical instabilities. The default value is 0.1.</p>
<p>The final argument is <code>t_save</code>. This sets how frequently <code><a href="../reference/project.html">project()</a></code> stores the state of the model in the resulting <code>MizerSim</code> object. For example, if <code>t_save</code> = 2, the state of the model is stored at t = 0, 2, 4… etc. <code>t_save</code> must be a multiple of <code>dt</code>. The default value of <code>t_save</code> is 1.</p>
</div>
<div id="setting-the-fishing-effort" class="section level2">
<h2 class="hasAnchor">
<a href="#setting-the-fishing-effort" class="anchor"></a>Setting the fishing effort</h2>
<p>The fishing effort argument describes the effort of the fishing gears in the model through time. We have already seen that information on the fishing gears and their selectivities and catchabilities is stored in the <code>MizerParams</code> argument.</p>
<p>There are three ways of setting the fishing effort. Examples of all three can be seen in <a href="running_a_simulation.html#sec:projection_examples">the section on projection examples.</a></p>
<p>The simplest way is by passing the <code>effort</code> argument as a single number. This value is then used as the fishing effort by all of the gears at each time step of the projection, i.e. fishing effort is constant throughout the simulation and is the same for all gears. We have seen this method in the community and trait-based model sections above. The length of the simulation is determined by the <code>t_max</code> argument.</p>
<p>The second method for setting the fishing effort is to use a numeric vector that has the same length as the number of gears. The values in the vector are used as the fishing effort of each gear at each time step, i.e. again, the fishing effort is constant through time but now each gear can have a different constant effort. The effort vector must be named and the names must be the same as the gears in the <code>MizerParams</code> object. Again, the length of the simulation is determined by the <code>t_max</code> argument.</p>
<p>Finally, the most sophisticated way of setting the fishing effort is to use a two-dimensional array or matrix of values, set up as time step by gear. Each row of the array has the effort values of each fishing gear by time. The array must have dimension names. The names of the first dimension (the row names) are the times. The steps between the times can be greater than the <code>dt</code> argument but must be contiguous. The names of the second dimension (the column names) must match the names of the gears in the <code>MizerParams</code> object used in the projection.</p>
<p>It is not necessary to supply a <code>t_max</code> argument when the effort is specified as an array because the maximum time of the simulation is taken from the dimension names. If a value for <code>t_max</code> is also supplied it is ignored.</p>
</div>
<div id="sec:setting_initial_abundances" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:setting_initial_abundances" class="anchor"></a>Setting the initial population abundance</h2>
<p>When running a simulation with the <code><a href="../reference/project.html">project()</a></code> method, the initial populations of the species and the plankton spectrum need to be specified. These are passed to <code><a href="../reference/project.html">project()</a></code> as the arguments <code>initial_n</code> and <code>initial_n_pp</code> respectively. <code>initial_n</code> is a matrix (with dimensions species x size) that contains the initial abundances of each species at size (the sizes must match those in the species size spectrum). <code>initial_n_pp</code> is a vector of the same length as the the length of the full spectrum (which can be seen as slot <code>w_full</code> in the <code>MizerParams</code> object).</p>
<p>By default, the <code>initial_n</code> argument has values automatically calculated by the function <code><a href="../reference/get_initial_n.html">get_initial_n()</a></code>. The default value for <code>initial_n_pp</code> is the carrying capacity of the plankton spectrum, stored in the <code>cc_pp</code> slot of the <code>MizerParams</code> parameters object.</p>
</div>
<div id="sec:mizersim" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:mizersim" class="anchor"></a>What do you get from running <code>project()?</code>
</h2>
<p>Running <code><a href="../reference/project.html">project()</a></code> returns an object of type <code>MizerSim</code> that stores the results of the projection. Like the <code>MizerParams</code> class this is also made up of various <em>slots</em>, which can be accessed using the <code>@</code> operator. An object of <code>MizerSim</code> has four slots, details of which can be seen in the help page (<code>help("MizerSim-class"</code>). The <code>params</code> slot holds the <code>MizerParams</code> object that was passed in to <code><a href="../reference/project.html">project()</a></code>. The <code>effort</code> slot holds the fishing effort of each gear through time. Note that the <code>effort</code> slot may not be exactly the same as the <code>effort</code> argument that was passed in to <code><a href="../reference/project.html">project()</a></code>. This is because only the saved effort is stored (the frequency of saving is determined by the argument <code>t_save</code>). The <code>n</code> and <code>n_pp</code> slots hold the saved abundances of the species and the plankton population at size respectively.</p>
</div>
<div id="sec:projection_examples" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:projection_examples" class="anchor"></a>Projection examples</h2>
<p>In this section we’ll look at how to run simulations with the <code><a href="../reference/project.html">project()</a></code> method. The examples will focus on how fishing effort can be specified in different ways. The results of the simulations will not be explored in detail. We will leave that for <a href="exploring_the_simulation_results.html#">the section on exploring the simulation results.</a>.</p>

<p>Remember that the fishing mortality by size on a species is the product of the selectivity, the catchability and the effort of the gear that caught it. We have not specified any catchability values in the species parameter data.frame so the default value of 1 is used. The selectivity ranges between 0 and 1. This means that in these examples the fishing mortality of a fully selected species is given by the effort of the gear that catches it.</p>
<div id="projections-with-single-simple-constant-effort" class="section level3">
<h3 class="hasAnchor">
<a href="#projections-with-single-simple-constant-effort" class="anchor"></a>Projections with single, simple constant effort</h3>
<p>When we use a single value for the <code>effort</code> argument, the value is used as a constant effort for all the gears. This method can be particularly useful for quickly projecting forward without fishing (you just set the <code>effort</code> argument to 0).</p>
<p>We will use the <code>params</code> object that was created in <a href="multispecies_model.html#sec:params_example">the section with examples of making a MizerParams objects</a> in which each species is caught by a separate gear. Here we make the object again:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_multispecies_model.html">set_multispecies_model</a></span>(params_data, <span class="dt">interaction =</span> inter)</a></code></pre></div>
<pre><code>## Note: No sel_func column in species data frame. Setting selectivity to be 'knife_edge' for all species.</code></pre>
<pre><code>## Note: No knife_edge_size column in species data frame. Setting knife edge selectivity equal to w_mat.</code></pre>
<pre><code>## Note: No h provided for some species, so using f0 and k_vb to calculate it.</code></pre>
<pre><code>## Note: No ks column in species data frame so using ks = h * 0.2.</code></pre>
<pre><code>## Note: Using z0 = z0pre * w_inf ^ z0exp for missing z0 values.</code></pre>
<pre><code>## Note: No gamma provided for some species, so using f0, h, beta, sigma, lambda and kappa to calculate it.</code></pre>
<p>As described above, effort is associated with fishing gears. Because we haven’t specified any gears in the <code>params_data</code> species parameter data.frame, each species is caught by a separate gear, named after the species.</p>
<p>As well as thinking about the <code>effort</code> argument we also need to consider the time parameters. We will project the populations forward until time equals 10 (<code>t_max</code> = 10), with a time step of 0.1 (<code>dt</code> = 0.1), saving the output every time step (<code>t_save</code> = 1). We use a constant effort value of 1.0.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params, <span class="dt">effort =</span> <span class="dv">1</span>, <span class="dt">t_max =</span> <span class="dv">10</span>, <span class="dt">dt =</span> <span class="fl">0.1</span>, <span class="dt">t_save =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>The resulting <code>sim</code> object is of class <code>MizerSim</code>. At this point we won’t explore how the results can be investigated in detail. However, we will use the basic summary plot that you have seen before:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim)</a></code></pre></div>
<div class="figure">
<img src="running_a_simulation_files/figure-html/plot_basic_ms_sim-1.png" alt="Plot of the North Sea multispecies model with no default fishing gears and constant effort of 1." width="700"><p class="caption">
Plot of the North Sea multispecies model with no default fishing gears and constant effort of 1.
</p>
</div>
<p>Without fishing the community settles down to equilibrium at about t = 50. The big difference between this multispecies model and the trait-based model can be seen in the range of M2 and feeding level values. With the trait-based model all the <em>species</em> had the same M2 and feeding level patterns. Here the species all have different patterns, driven by their differing life history characteristics and the heterogeneous interaction matrix.</p>
<p>You can also see in the above figure that each species has different fishing selectivity (see the Total fishing mortality panel). Remember that the default setting for the fishing gears is a knife-edge gear where the knife-edge is positioned at the species <code>w_mat</code> parameter.</p>
<p>The effort through time can be inspected by looking at the <code>effort</code> slot (we use the <code><a href="https://www.rdocumentation.org/packages/utils/topics/head">head()</a></code> function to just show the first few lines). The <code>effort</code> slot shows the effort by time and gear. You can see here that each species is caught by a separate gear, and the gear is named after the species. In this example, we specified the <code>effort</code> argument as a single numeric of value 1. As you can see this results in the same effort being used for all gears for all time steps:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sim<span class="op">@</span>effort)</a></code></pre></div>
<pre><code>##     gear
## time Sprat Sandeel N.pout Herring Dab Whiting Sole Gurnard Plaice Haddock
##    0     1       1      1       1   1       1    1       1      1       1
##    1     1       1      1       1   1       1    1       1      1       1
##    2     1       1      1       1   1       1    1       1      1       1
##    3     1       1      1       1   1       1    1       1      1       1
##    4     1       1      1       1   1       1    1       1      1       1
##    5     1       1      1       1   1       1    1       1      1       1
##     gear
## time Cod Saithe
##    0   1      1
##    1   1      1
##    2   1      1
##    3   1      1
##    4   1      1
##    5   1      1</code></pre>
<p>A <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code> method is also available for objects of type <code>MizerSim</code>. This is essentially the same as the summary for <code>MizerParams</code> objects, but includes information on the simulation time parameters.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(sim)</a></code></pre></div>
<p>If we decrease <code>t_save</code> but keep <code>t_max</code> the same then we can see that the time dimension of the <code>effort</code> slot changes accordingly. This will also be true of the <code>n</code> and <code>n_pp</code> slots. Here we reduce <code>t_save</code> to 0.5, meaning that the effort and abundance information is stored at t = 1.0, 1.5, 2.0 etc.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_gears, <span class="dt">effort =</span> <span class="dv">1</span>, <span class="dt">t_max =</span> <span class="dv">10</span>, <span class="dt">dt =</span> <span class="fl">0.1</span>, <span class="dt">t_save =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sim<span class="op">@</span>effort)</a></code></pre></div>
<pre><code>##      gear
## time  Industrial Pelagic Beam Otter
##   0            1       1    1     1
##   0.5          1       1    1     1
##   1            1       1    1     1
##   1.5          1       1    1     1
##   2            1       1    1     1
##   2.5          1       1    1     1</code></pre>
</div>
<div id="sec:proj_diff_gears_constant_effort" class="section level3">
<h3 class="hasAnchor">
<a href="#sec:proj_diff_gears_constant_effort" class="anchor"></a>Setting constant effort for different gears</h3>
<p>As mentioned above, we can also set the effort values for each gear separately using a vector of effort values. This still keeps the efforts constant through time but it means that each gear can have a different constant effort.</p>
<p>Here we will use the <code>MizerParams</code> object with four gears, <code>params_gears</code>, that we created in <a href="multispecies_model.html#sec:setting_different_gears">the section on setting up different gears.</a> The names of the gears are Industrial, Pelagic, Beam, Otter. We need to create a named vector of effort, where the names match the gears. For example, here we want to switch off the industrial gear (i.e. effort = 0), keep the pelagic gear effort at 1, set the effort of the beam trawl gears to 0.3 and the effort of the otter trawl gear to 0.7. We set the <code>effort</code> like this:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">effort &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">Industrial =</span> <span class="dv">0</span>, <span class="dt">Pelagic =</span> <span class="dv">1</span>, <span class="dt">Beam =</span> <span class="fl">0.3</span>, <span class="dt">Otter =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<p>We then call <code><a href="../reference/project.html">project()</a></code> with this effort and inspect the resulting <code>effort</code> slot (again we use the <code><a href="https://www.rdocumentation.org/packages/utils/topics/head">head()</a></code> function to just show the first few lines):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_gears, <span class="dt">effort =</span> effort, <span class="dt">t_max =</span> <span class="dv">10</span>, <span class="dt">dt =</span> <span class="dv">1</span>, <span class="dt">t_save =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sim<span class="op">@</span>effort)</a></code></pre></div>
<pre><code>##     gear
## time Industrial Pelagic Beam Otter
##    0          0       1  0.3   0.7
##    1          0       1  0.3   0.7
##    2          0       1  0.3   0.7
##    3          0       1  0.3   0.7
##    4          0       1  0.3   0.7
##    5          0       1  0.3   0.7</code></pre>
<p>You can see that the effort for each gear is constant but each gear has the effort that was specified in the <code>effort</code> argument.</p>
<p>This impact of this can be seen plotting the fishing mortality. There is a dedicated plot, <code><a href="../reference/plotFMort.html">plotFMort()</a></code>, that shows the fishing mortality at size for each species at a particular time step (the default is the final time step). The fishing mortality on each of the species is determined by the effort of the gear that caught it.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/plotFMort.html">plotFMort</a></span>(sim)</a></code></pre></div>
<div class="figure">
<img src="running_a_simulation_files/figure-html/plotFMort-1.png" alt="An example of using the `plotFMort()` method to show how different efforts for different gears can be specified." width="700"><p class="caption">
An example of using the <code><a href="../reference/plotFMort.html">plotFMort()</a></code> method to show how different efforts for different gears can be specified.
</p>
</div>
</div>
<div id="an-example-of-changing-effort-through-time" class="section level3">
<h3 class="hasAnchor">
<a href="#an-example-of-changing-effort-through-time" class="anchor"></a>An example of changing effort through time</h3>
<p>In this example we set up a more complicated fishing effort structure that allows the fishing effort of each gear to change through time. As mentioned above, to do this, effort must be supplied as a two dimensional array or matrix. The first dimension is time and the second dimension is gear. The dimensions must be named. The gear names must match the gears in the <code>MizerParams</code> object. Also, as mentioned above, if effort is passed in as an array then the length of the simulation is determined by the time dimension names and the argument <code>t_max</code> is not used. Instead the simulation runs from the earliest time in the effort array to the latest.</p>
<p>Here, we will use the <code>params_gears</code> object we created in <a href="multispecies_model.html#sec:setting_different_gears">the section on setting up different fishing gears</a> which has four gears. The names of the gears are Industrial, Pelagic, Beam, Otter.</p>
<p>In this example, we will project forward from time <span class="math inline">\(t=1\)</span> to time <span class="math inline">\(t=10\)</span>. The effort of the industrial gear is held constant at 0.5, the effort of the pelagic gear is increased linearly from 1 to 2, the effort of the beam trawl decreases linearly from 1 to 0, whilst the effort of the otter trawl decreases linearly from 1 to 0.5.</p>
<p>First we create the empty <code>effort</code> array:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">gear_names &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Industrial"</span>,<span class="st">"Pelagic"</span>,<span class="st">"Beam"</span>,<span class="st">"Otter"</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">times &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">effort_array &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(times), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(gear_names)),</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">    <span class="dt">dimnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">time =</span> times, <span class="dt">gear =</span> gear_names))</a></code></pre></div>
<p>Then we fill it up, one gear at a time, making heavy use of the <code><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq()</a></code> function to create a sequence:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">effort_array[,<span class="st">"Industrial"</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">effort_array[,<span class="st">"Pelagic"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(times))</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">effort_array[,<span class="st">"Beam"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">0</span>, <span class="dt">length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(times))</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">effort_array[,<span class="st">"Otter"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="fl">0.5</span>, <span class="dt">length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(times))</a></code></pre></div>
<p>The first few rows of the effort array are shown as an illustration:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(effort_array)</a></code></pre></div>
<pre><code>##     gear
## time Industrial  Pelagic      Beam     Otter
##    1        0.5 1.000000 1.0000000 1.0000000
##    2        0.5 1.111111 0.8888889 0.9444444
##    3        0.5 1.222222 0.7777778 0.8888889
##    4        0.5 1.333333 0.6666667 0.8333333
##    5        0.5 1.444444 0.5555556 0.7777778
##    6        0.5 1.555556 0.4444444 0.7222222</code></pre>
<p>The first row gives the effort between times 1 and 2, the second between times 2 and 3, and so on. The time 10 row in the array is not actually used, except to set the final time for the simulation. Now we can use this effort array in the projection:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_gears,<span class="dt">effort=</span>effort_array, <span class="dt">dt=</span><span class="fl">0.1</span>, <span class="dt">t_save =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(sim<span class="op">@</span>effort)</a></code></pre></div>
<pre><code>##     gear
## time Industrial  Pelagic      Beam     Otter
##    1        0.5 1.000000 1.0000000 1.0000000
##    2        0.5 1.111111 0.8888889 0.9444444
##    3        0.5 1.222222 0.7777778 0.8888889
##    4        0.5 1.333333 0.6666667 0.8333333
##    5        0.5 1.444444 0.5555556 0.7777778
##    6        0.5 1.555556 0.4444444 0.7222222</code></pre>
<p>As you can see, it can be quite fiddly to set up a complicated effort array so it may be easier to prepare it in advance as a .csv file and read it in, similar to how we read in the interaction matrix in <a href="multispecies_model.html#sec:params_example">the section with an examples of making a MizerParams object.</a> We give an example of this in <a href="a_multispecies_model_of_the_north_sea.html">the section on the North Sea model.</a></p>
<p>Note that in this example we set up the effort array so that the effort was set every whole time step (e.g. time = 1, 2, etc). This does not have to be the case and it is possible to set the effort more frequently than that, e.g. at time = 1.0, 1.5, 2.0, 2.5 etc. The only restriction is that the difference between time dimension names must be at least as big as the <code>dt</code> argument.</p>
<p>Now that we know how to run a simulation, the we are ready to learn how to <a href="exploring_the_simulation_results.html">explore the simulation results.</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sec:projection">Introduction</a></li>
      <li><a href="#sec:time_arguments">The time arguments</a></li>
      <li><a href="#setting-the-fishing-effort">Setting the fishing effort</a></li>
      <li><a href="#sec:setting_initial_abundances">Setting the initial population abundance</a></li>
      <li><a href="#sec:mizersim">What do you get from running <code>project()?</code></a></li>
      <li>
<a href="#sec:projection_examples">Projection examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#projections-with-single-simple-constant-effort">Projections with single, simple constant effort</a></li>
      <li><a href="#sec:proj_diff_gears_constant_effort">Setting constant effort for different gears</a></li>
      <li><a href="#an-example-of-changing-effort-through-time">An example of changing effort through time</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Finlay Scott, Julia Blanchard, Ken Andersen, Gustav Delius.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9001.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'de91577b2f58755afaa137388a513a88',
    indexName: 'mizer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
