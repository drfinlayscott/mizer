<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Community Model • mizer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Community Model">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mizer</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mizer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../articles/publications.html">Publications</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sizespectrum/mizer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The Community Model</h1>
            
      
      <small class="dont-index"><a href="https://github.com/sizespectrum/mizer/edit/master/vignettes/community_model.Rmd">Edit this page.  </a> Source: <a href="https://github.com/sizespectrum/mizer/blob/master/vignettes/community_model.Rmd"><code>vignettes/community_model.Rmd</code></a></small>
      <div class="hidden name"><code>community_model.Rmd</code></div>

    </div>

    
    
<p>The simplest version of the size spectrum model is the community model. In the community model, individuals are only characterized by their size and are represented by a single group representing an across species average. Reproduction is not considered and the recruitment flux <span class="math inline">\(R\)</span> is set to be constant. The resource spectrum only extends to the start of the community spectrum. Standard metabolism is turned off.</p>
<p>In this section we describe how a community model can be set up and projected through time. We then use a community model to illustrate the idea of a ’trophic cascade’. Due to the relative simplicity of this type of model they are useful for gently introducing some of the concepts behind the mizer package. Consequently, this section should hopefully serve as an introduction to using mizer.</p>
<div id="sec:set_up_comm_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:set_up_comm_model" class="anchor"></a>Setting up a community model</h2>
<p>The first stage in implementing a model using <code>mizer</code> is to create an object of class <code>MizerParams</code>. This class contains the model parameters including the life-history parameters of the species in the model, the stock-recruitment relationships, the fishing selectivity functions and the parameters of the plankton spectrum.</p>
<p>To avoid having to make a <code>MizerParams</code> object directly, the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> wrapper function, has been provided that conveniently creates a <code>MizerParams</code> object specifically for a community model. The documentation for the function can be seen by entering:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">?set_community_model</a></code></pre></div>
<p>As can be seen in the help page, the function can take many arguments. We can ignore most of these for the moment as they almost all come with default values.</p>
<p>The arguments that you should pay attention to are: <code>z0</code> (the level of background mortality), <code>alpha</code> (the assimilation efficiency of the community), <code>f0</code> (the average feeding level of the community which is used to calculate <span class="math inline">\(\gamma,\)</span> as described in <a href="model_description.html#eq:gamma">the equation for gamma</a> and <code>recruitment</code> (the level of constant recruitment).</p>
<p>Although default values for these parameters are provided, you are encouraged to explore how changing the values affects the simulated community. For example, the default value of <code>z0</code> is 0.1. Increasing this value effectively ‘shortens’ the length of the community spectrum. The value of the constant recruitment should be set so that the community spectrum is a continuation of the plankton spectrum. This can be done with trial and error. A reasonable value for <code>alpha</code> is 0.2.</p>
<p>The <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function is called by passing in the arguments by name. Any parameter that is not passed in is set to the default value. For example, the following line sets up the parameters with <code>z0</code> = 0.1, <code>f0</code> = 0.7, <code>alpha</code> = 0.2 and <code>recruitment</code> = 4e7. All other parameters will have their default value:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_community_model.html">set_community_model</a></span>(<span class="dt">z0 =</span> <span class="fl">0.1</span>, <span class="dt">f0 =</span> <span class="fl">0.7</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">recruitment =</span> <span class="fl">4e7</span>)</a></code></pre></div>
<p>Calling the function creates and returns an object of type <code>MizerParams</code>. We can check this using the <code><a href="https://www.rdocumentation.org/packages/base/topics/class">class()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(params)</a></code></pre></div>
<pre><code>## [1] "MizerParams"
## attr(,"package")
## [1] "mizer"</code></pre>
<p>If you are going through this vignette for the first time, it is likely that you have no idea what a <code>MizerParams</code> object actually is. In R-speak it is an <em>S4</em> object, which means it is an object made up of <em>slots</em>. Slots are essentially containers that store the object data. The names of these slots can be seen by calling the <code>slotNames()</code> method on the object:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">slotNames</span>(params)</a></code></pre></div>
<pre><code>##  [1] "w"                 "dw"                "w_full"           
##  [4] "dw_full"           "w_min_idx"         "maturity"         
##  [7] "psi"               "initial_n"         "intake_max"       
## [10] "search_vol"        "rho"               "metab"            
## [13] "pred_kernel"       "ft_pred_kernel_e"  "ft_pred_kernel_p" 
## [16] "mu_b"              "rr_pp"             "cc_pp"            
## [19] "resource_dynamics" "plankton_dynamics" "resource_params"  
## [22] "sc"                "initial_n_pp"      "initial_B"        
## [25] "species_params"    "interaction"       "srr"              
## [28] "selectivity"       "catchability"      "n"                
## [31] "p"                 "lambda"            "q"                
## [34] "f0"                "kappa"             "A"                
## [37] "linecolour"        "linetype"</code></pre>
<p>As you can see, the <code>params</code> object is made up of lots of slots. A quick description can be found in the <a href="../reference/MizerParams-class.html"><code>MizerParams</code> help page</a> (run <code><a href="../reference/MizerParams-class.html">class ? MizerParams</a></code>. The slots of an object are accessed by using the <code>@</code> operator. For example, to access the <code>w</code> slot (which contains a vector of the size bins in the model) you would use</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">params<span class="op">@</span>w</a></code></pre></div>
<p>Rather than picking through the slots to find out what is in a particular <code>MizerParams</code> object, a summary of the object can be seen by calling the <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code> method on it:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(params)</a></code></pre></div>
<pre><code>## An object of class "MizerParams" 
## Consumer size spectrum:
##  minimum size:   0.001
##  maximum size:   1e+06
##  no. size bins:  100
## Plankton size spectrum:
##  minimum size:   1.87382e-08
##  maximum size:   1e+06
##  no. size bins:  152
## Species details:
##             species w_inf w_mat beta sigma
## Community Community 1e+06    NA  100     2
## Fishing gear details:
##  Gear            Target species
##   Community       Community</code></pre>
<p>In the summary you can see that the size range of the community spectrum has been set from <span class="math inline">\(0.001\)</span> to <span class="math inline">\(10^{6}\)</span> and these are spread over <span class="math inline">\(100\)</span> size bins. Similar information is available for the plankton spectrum. Additionally, the community is made up of only one species, called <em>Community</em>, which has an asymptotic size of <span class="math inline">\(10^{6}\)</span> and a preferred predator prey mass ratio of <span class="math inline">\(100\)</span>. The <code>w_mat</code> parameter has been set to <code>NA</code> as it is not used when running a community model. These values have all been set by default using the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function. If you want to set different values for these, you will need to call the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function and pass in the desired argument values.</p>
</div>
<div id="sec:running_comm_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:running_comm_model" class="anchor"></a>Running the community model</h2>
<p>By using the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function we now have a <code>MizerParams</code> object that contains all the information we need about the model community. We can use this to perform a simulation and project the community through time. In the <code>mizer</code> package, projections are performed using the <code><a href="../reference/project.html">project()</a></code> function. You can see the help page for <code><a href="../reference/project.html">project()</a></code> for more details and it is described fully in <a href="running_a_simulation.html">the section on running a simulation.</a> We will ignore the details for the moment and just use <code><a href="../reference/project.html">project()</a></code> to run some simple projections. The arguments for <code><a href="../reference/project.html">project()</a></code> that we need to be concerned with are <code>effort</code>, which determines the fishing effort (and therefore fishing mortality) through time, and <code>t_max</code>, which is the length of the simulation. Initial population abundances are set automatically by the <code><a href="../reference/get_initial_n.html">get_initial_n()</a></code> function. It is possible to set your own initial abundances but we will not do this here.</p>
<p>To run a projection for 50 time steps, with no fishing effort (i.e. we want to model an unexploited community) we run:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">sim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params, <span class="dt">t_max =</span> <span class="dv">50</span>, <span class="dt">effort =</span> <span class="dv">0</span>)</a></code></pre></div>
<p>The resulting object, <code>sim</code>, is of type <code>MizerSim</code>. This class holds the results of the simulation, including the community and plankton abundances at size through time, as well as the original model parameters. It is explained in detail in <a href="running_a_simulation.html">the section on running a simulation.</a></p>
<p>After running the projection, it is possible to explore the results using a range of plots and analyses. These are described fully in <a href="exploring_the_simulation_results.html">the section on exploring the simulation results.</a></p>
<p>To quickly look at the results of the projection you can call the generic <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> method. This plots the feeding level, predation mortality, fishing mortality and abundance by size in the last time step of the simulation, and the biomass through time. Each of the plots can be show individually if desired.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim)</a></code></pre></div>
<div class="figure">
<img src="community_model_files/figure-html/print_plot_comm_sim-1.png" alt="Example plot of the community model." width="700"><p class="caption">
Example plot of the community model.
</p>
</div>
<p>In the above plot there are several things going on that are worth talking about. Looking at the total biomass of the community against time, you can see that the biomass quickly reaches a stable equilibrium. The other panels show what is happening at the last time step in the simulation, which in this case is when the community is at equilibrium. Fishing mortality is 0 because we set the <code>effort</code> argument to 0 when running the simulation. The predation mortality rate is clearly a function of size, with the smallest sizes experiencing the highest levels of predation. The feeding level describes how satiated an individual is, with 0 being unfed, and 1 being full satiated. The feeding level at size will be strongly affected by the values of the <code>f0</code> and <code>alpha</code> arguments passed to the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function. The plankton and community spectra are shown in the bottom panel of the plot (the plotted plankton spectrum has been truncated to make for a better plot, but really extends all the way back to <span class="math inline">\(1.87\times 10^{-8}\)</span> g). You can see that the community spectrum forms a continuum with the plankton spectrum. This is strongly affected by the level of fixed recruitment (the <code>recruitment</code> argument passed to <code><a href="../reference/set_community_model.html">set_community_model()</a></code>).</p>
<p>Note the hump in the biomass at the largest end of the community spectrum. This is because the size spectrum model can be broadly described as ‘big things eating little things’. Given this, what is eating the very biggest things? Without fishing pressure, the mortality of the largest individuals is only from the background mortality (determined by the <code>z0</code> argument) and the mortality from predation is almost 0. This is difficult to see in the plot due to the predation mortality being so high for the smaller individuals.</p>
<p>We can see this more clearly by extracting the predation mortality information from the <code>MizerSim</code> object, <code>sim</code>, that we created above. This is easily done by using the <code><a href="../reference/getPredMort.html">getPredMort()</a></code> function (see the help page for more details). There are several functions that can be used for extracting information from a <code>MizerSim</code> object, e.g. <code><a href="../reference/getFeedingLevel.html">getFeedingLevel()</a></code> and <code><a href="../reference/getFMort.html">getFMort()</a></code>. For more information see <a href="exploring_the_simulation_results.html">the section on exploring the simulation results</a>. Here we just call <code><a href="../reference/getPredMort.html">getPredMort()</a></code> using the <code>sim</code> object:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">m2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/getPredMort.html">getPredMort</a></span>(sim)</a></code></pre></div>
<p>The resulting <code>m2</code> object is an array that contains the predation mortality at time by species by size. Here we only have one species so the species dimension is dropped, leaving us with a two dimensional array of time by size. We projected the model for <span class="math inline">\(50\)</span> time steps but the length of the time dimension is <span class="math inline">\(51\)</span> as the initial population is also included as a time step.</p>
<p>To pull out the predation mortality at size in the final time step we use:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">m2[<span class="dv">51</span>,]</a></code></pre></div>
<p>If you plot this predation mortality on a log-log scale you can see how the predation mortality declines to almost zero for the largest sizes.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> sim<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y =</span> m2[<span class="dv">51</span>,], <span class="dt">log =</span> <span class="st">"xy"</span>, <span class="dt">type =</span> <span class="st">"l"</span>, </a>
<a class="sourceLine" id="cb14-2" data-line-number="2">     <span class="dt">xlab =</span> <span class="st">"Size"</span>, <span class="dt">ylab =</span> <span class="st">"Predation mortality"</span>)</a></code></pre></div>
<div class="figure">
<img src="community_model_files/figure-html/print_plot_comm_m2-1.png" alt="Predation mortality without fishing in the community model (note the log scales for both axes)." width="700"><p class="caption">
Predation mortality without fishing in the community model (note the log scales for both axes).
</p>
</div>
</div>
<div id="sec:trophic_cascade_comm_model" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:trophic_cascade_comm_model" class="anchor"></a>Example of a trophic cascade with the community model</h2>
<p>It is possible to use the community model to simulate a trophic cascade. To do this we need to perform two simulations, one with fishing and one without.</p>
<p>This means we need to consider how fishing is handled in <code>mizer</code>. The <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function automatically sets the fishing selectivity to have a knife-edge shape, with only individuals larger than 1 kg selected (the size at the knife-edge can be changed by setting the <code>knife_edge_size</code> argument). Although it is possible to change the selectivity function, here we will use the default knife-edge selectivity. We set up the parameter object exactly as before, but now we are explicitly setting the size at which individuals are selected by the fishing gear.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">params_knife &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_community_model.html">set_community_model</a></span>(<span class="dt">z0 =</span> <span class="fl">0.1</span>, <span class="dt">recruitment =</span> <span class="fl">4e7</span>,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">    <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">f0 =</span> <span class="fl">0.7</span>, <span class="dt">knife_edge_size =</span> <span class="dv">1000</span>)</a></code></pre></div>
<p>First we perform a simulation without fishing in the same way we did above by setting the <code>effort</code> argument to 0:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sim0 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_knife, <span class="dt">effort =</span> <span class="dv">0</span>, <span class="dt">t_max =</span> <span class="dv">50</span>)</a></code></pre></div>
<p>Now we want to simulate again, this time with fishing. In the simulations, fishing mortality is calculated as the product of the fishing selectivity, effort and catchability (see <a href="multispecies_model.html#sec:fishing_gear">the section on fishing gears</a> for more details). By default catchability is set to 1. This means that a fishing effort of 1 will result in a fishing mortality of 1 for fully selected sizes. Here we run a simulation with fishing effort set to 1 for the duration of the simulation:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sim1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_knife, <span class="dt">effort =</span> <span class="dv">1</span>, <span class="dt">t_max =</span> <span class="dv">50</span>)</a></code></pre></div>
<p>You can compare the difference between these scenarios by using the <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> method as before. Of particular interest is the fishing mortality at size. The knife-edge selectivity at 1000 g can be clearly seen and an effort of 1 has resulted in a fishing mortality of 1 for the fully selected sizes.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sim1)</a></code></pre></div>
<div class="figure">
<img src="community_model_files/figure-html/print_plot_comm_fmort-1.png" alt="Summary plot for the community model when fishing with knife-edge selectivity at size = 1000 g." width="700"><p class="caption">
Summary plot for the community model when fishing with knife-edge selectivity at size = 1000 g.
</p>
</div>
<p>To explore the presence of a trophic cascade, we are interested in looking at the relative change in abundance when the community is fished compared to when it is not fished. To do this we need to get the abundances at size from the simulation objects. The abundances are stored in the <code>n</code> slot of the <code>MizerSim</code> objects. The <code>n</code> slot contains a three dimensional array with dimensions time x species x size. Here we have 51 time steps (50 from the simulation plus one which stores the initial population), 1 species and 100 sizes:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(sim0<span class="op">@</span>n)</a></code></pre></div>
<pre><code>## [1]  51   1 100</code></pre>
<p>We want the abundances in the final time step, and we can use these to calculate the relative abundances:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">relative_abundance &lt;-<span class="st"> </span>sim1<span class="op">@</span>n[<span class="dv">51</span>,,] <span class="op">/</span><span class="st"> </span>sim0<span class="op">@</span>n[<span class="dv">51</span>,,]</a></code></pre></div>
<p>This can then be plotted using basic R plotting commands. The sizes are stored in the <code>params@w</code> slot (a slot of a slot!).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="dt">x =</span> sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y =</span> relative_abundance, <span class="dt">log =</span> <span class="st">"x"</span>, <span class="dt">type =</span> <span class="st">"n"</span>,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">    <span class="dt">xlab =</span> <span class="st">"Size (g)"</span>, <span class="dt">ylab =</span> <span class="st">"Relative abundance"</span>)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> sim0<span class="op">@</span>params<span class="op">@</span>w, <span class="dt">y =</span> relative_abundance)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(sim0<span class="op">@</span>params<span class="op">@</span>w), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(sim0<span class="op">@</span>params<span class="op">@</span>w)), <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="figure">
<img src="community_model_files/figure-html/plot_relative_comm_abund-1.png" alt="Relative abundances from the unfished (dashed line) and fished (solid line) community model." width="700"><p class="caption">
Relative abundances from the unfished (dashed line) and fished (solid line) community model.
</p>
</div>
<p>The impact of fishing on species larger than 1000g can be clearly seen. The fishing pressure lowers the abundance of large fish (the decrease in relative abundance at 1000 g). This then relieves the predation pressure on their smaller prey (the preferred predator-prey size ratio is given by the <span class="math inline">\(\beta\)</span> parameter, which is set to 100 by default), leading to an increase in their abundance. This in turn increases the predation mortality on their smaller prey, which reduces their abundance and so on.</p>
</div>
<div id="sec:comm_model_change_sigma" class="section level2">
<h2 class="hasAnchor">
<a href="#sec:comm_model_change_sigma" class="anchor"></a>The impact of changing <span class="math inline">\(\sigma\)</span>
</h2>
<p>As described above, the <span class="math inline">\(\sigma\)</span> parameter determines the width of the predator prey size preference. Here we take a look at how changing the value of <span class="math inline">\(\sigma\)</span> can affect the dynamics of the community. In the examples above, <span class="math inline">\(\sigma\)</span> is set in the <code><a href="../reference/set_community_model.html">set_community_model()</a></code> function by default to a value of <span class="math inline">\(2\)</span>. When projected through time, the community abundances converge to a stable equilibrium. What happens if we reduce the value of <span class="math inline">\(\sigma\)</span>, for example by setting it to 1.0? We can do this by passing in the new value of <span class="math inline">\(\sigma\)</span> into <code><a href="../reference/set_community_model.html">set_community_model()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">params_sigma1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_community_model.html">set_community_model</a></span>(<span class="dt">z0 =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">     <span class="dt">f0 =</span> <span class="fl">0.7</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">recruitment =</span> <span class="fl">4e7</span>, <span class="dt">sigma =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>We want to project this new model through time using the <code><a href="../reference/project.html">project()</a></code> function. Note that we have introduced a new argument: <span class="math inline">\(dt\)</span>. This is the step size of the solver. It does not have anything to do with the biology in the model. It only affects the internal engine of <code><a href="../reference/project.html">project()</a></code> that performs the projection.</p>
<p>As you can see in the underlying model equations in <a href="model_description.html">the model description section</a>, the model runs in continuous time. Therefore, to project it forward, <code><a href="../reference/project.html">project()</a></code> must solve the system of equations using numerical methods. The quality of these methods is strongly affected by <span class="math inline">\(dt\)</span>. The default value of <span class="math inline">\(dt\)</span> is 0.1, which will be fine for most of the projections we run in this Vignette. Here it is necessary to reduce the value to 0.01 to avoid introducing any artefacts into the projected values. Decreasing <span class="math inline">\(dt\)</span> increases the time it takes to run a projection. Here we project the new parameters object for 50 time steps without fishing:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">sim_sigma1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project.html">project</a></span>(params_sigma1, <span class="dt">effort =</span> <span class="dv">0</span>, <span class="dt">t_max =</span> <span class="dv">50</span>, <span class="dt">dt=</span><span class="fl">0.01</span>)</a></code></pre></div>
<p>Let’s take a look at how the abundances change through time. We can do this with the <code><a href="../reference/plotBiomass.html">plotBiomass()</a></code> function:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="../reference/plotBiomass.html">plotBiomass</a></span>(sim_sigma1)</a></code></pre></div>
<div class="figure">
<img src="community_model_files/figure-html/plot_comm_biomass_sigma1-1.png" alt="Biomass of the community model when sigma is reduced to a value of 1.0." width="700"><p class="caption">
Biomass of the community model when sigma is reduced to a value of 1.0.
</p>
</div>
<p>The plot above shows that abundances of the community no longer converge to a stable equilibrium and the dynamics appear to be chaotic. The ecological significance of the change in dynamics, and of the ability of simple community models to show chaotic behaviour, is still being debated. It can be argued that the size of the oscillations are too large to be ‘true’. Additionally, when a trait-based model is implemented, the magnitude of the oscillations are much smaller. The next section is about <a href="trait_model.html">the trait based model.</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sec:set_up_comm_model">Setting up a community model</a></li>
      <li><a href="#sec:running_comm_model">Running the community model</a></li>
      <li><a href="#sec:trophic_cascade_comm_model">Example of a trophic cascade with the community model</a></li>
      <li><a href="#sec:comm_model_change_sigma">The impact of changing <span class="math inline">\(\sigma\)</span></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Finlay Scott, <a href="http://www.utas.edu.au/profiles/staff/imas/julia-blanchard">Julia Blanchard</a>, <a href="https://ken.haste.dk/">Ken Andersen</a>, <a href="https://www.york.ac.uk/maths/staff/gustav-delius/">Gustav Delius</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
